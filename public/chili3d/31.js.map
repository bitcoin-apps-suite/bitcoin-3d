{"version":3,"file":"31.js","sources":["webpack://chili3d/./packages/chili-ui/src/dialog.ts","webpack://chili3d/./packages/chili-ui/src/okCancel.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/treeItem.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/treeItemGroup.ts","webpack://chili3d/./packages/chili-ui/src/project/toolBar.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/treeModel.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/tree.ts","webpack://chili3d/./packages/chili-ui/src/project/projectView.ts","webpack://chili3d/./packages/chili-ui/src/property/propertyBase.ts","webpack://chili3d/./packages/chili-ui/src/property/input.ts","webpack://chili3d/./packages/chili-ui/src/property/matrixProperty.ts","webpack://chili3d/./packages/chili-ui/src/property/check.ts","webpack://chili3d/./packages/chili-ui/src/property/colorProperty.ts","webpack://chili3d/./packages/chili-ui/src/property/material/textureEditor.ts","webpack://chili3d/./packages/chili-ui/src/property/materialProperty.ts","webpack://chili3d/./packages/chili-ui/src/property/utils.ts","webpack://chili3d/./packages/chili-ui/src/property/propertyView.ts","webpack://chili3d/./packages/chili-ui/src/property/material/materialDataContent.ts","webpack://chili3d/./packages/chili-ui/src/property/material/materialEditor.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/commandContext.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbonButton.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbonStack.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbon.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbonData.ts","webpack://chili3d/./packages/chili-ui/src/statusbar/snapConfig.ts","webpack://chili3d/./packages/chili-ui/src/statusbar/statusbar.ts","webpack://chili3d/./packages/chili-ui/src/cursor/index.ts","webpack://chili3d/./packages/chili-ui/src/viewport/flyout/input.ts","webpack://chili3d/./packages/chili-ui/src/viewport/flyout/tip.ts","webpack://chili3d/./packages/chili-ui/src/viewport/flyout/flyout.ts","webpack://chili3d/./packages/chili-ui/src/viewport/viewport.ts","webpack://chili3d/./packages/chili-ui/src/viewport/layoutViewport.ts","webpack://chili3d/./packages/chili-ui/src/editor.ts","webpack://chili3d/./packages/chili-ui/src/home/languageSelector.ts","webpack://chili3d/./packages/chili-ui/src/home/navigation3DSelector.ts","webpack://chili3d/./packages/chili-ui/src/home/themeSelector.ts","webpack://chili3d/./packages/chili-ui/src/home/home.ts","webpack://chili3d/./packages/chili-ui/src/permanent.ts","webpack://chili3d/./packages/chili-ui/src/toast/toast.ts","webpack://chili3d/./packages/chili-ui/src/mainWindow.ts"],"sourcesContent":["// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { button, div } from \"chili-controls\";\nimport { DialogResult, I18n, I18nKeys } from \"chili-core\";\nimport style from \"./dialog.module.css\";\n\nexport class Dialog {\n    private constructor() {}\n\n    static show(title: I18nKeys, content: HTMLElement, callback?: (result: DialogResult) => void) {\n        const dialog = document.createElement(\"dialog\");\n        document.body.appendChild(dialog);\n\n        dialog.appendChild(\n            div(\n                { className: style.root },\n                div({ className: style.title }, I18n.translate(title) ?? \"chili3d\"),\n                div({ className: style.content }, content),\n                div(\n                    { className: style.buttons },\n                    button({\n                        textContent: I18n.translate(\"common.confirm\"),\n                        onclick: () => {\n                            dialog.remove();\n                            callback?.(DialogResult.ok);\n                        },\n                    }),\n                    button({\n                        textContent: I18n.translate(\"common.cancel\"),\n                        onclick: () => {\n                            dialog.remove();\n                            callback?.(DialogResult.cancel);\n                        },\n                    }),\n                ),\n            ),\n        );\n\n        dialog.showModal();\n    }\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, span, svg } from \"chili-controls\";\nimport { AsyncController, I18nKeys, Localize } from \"chili-core\";\nimport style from \"./okCancel.module.css\";\n\nexport class OKCancel extends HTMLElement {\n    private control?: AsyncController;\n\n    constructor() {\n        super();\n        this.className = style.root;\n        this.append(this.container());\n    }\n\n    private container() {\n        return div(\n            { className: style.container },\n            span({ textContent: new Localize(\"ribbon.group.selection\") }),\n            div({ className: style.spacer }),\n            this.buttons(),\n        );\n    }\n\n    private buttons() {\n        return div(\n            { className: style.panel },\n            this._createIcon(\"icon-confirm\", \"common.confirm\", this._onConfirm),\n            this._createIcon(\"icon-cancel\", \"common.cancel\", this._onCancel),\n        );\n    }\n\n    private _createIcon(icon: string, text: I18nKeys, onClick: () => void) {\n        return div(\n            {\n                className: style.icon,\n                onclick: onClick,\n            },\n            svg({ icon }),\n            span({ textContent: new Localize(text) }),\n        );\n    }\n\n    setControl(control: AsyncController | undefined) {\n        this.control = control;\n    }\n\n    private readonly _onConfirm = () => {\n        this.control?.success();\n    };\n\n    private readonly _onCancel = () => {\n        this.control?.cancel();\n    };\n}\n\ncustomElements.define(\"ok-cancel\", OKCancel);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { label, setSVGIcon, svg } from \"chili-controls\";\nimport { Binding, IDocument, INode, Transaction } from \"chili-core\";\nimport style from \"./treeItem.module.css\";\n\nexport abstract class TreeItem extends HTMLElement {\n    readonly name: HTMLLabelElement;\n    readonly visibleIcon: SVGSVGElement;\n\n    private _node: INode;\n    get node() {\n        return this._node;\n    }\n\n    constructor(\n        private document: IDocument,\n        node: INode,\n    ) {\n        super();\n        this._node = node;\n        this.draggable = true;\n        this.name = label({\n            className: style.name,\n            textContent: new Binding(node, \"name\"),\n        });\n        this.visibleIcon = svg({\n            className: style.icon,\n            icon: this.getVisibleIcon(),\n            onclick: this.onVisibleIconClick,\n        });\n        this.setVisibleStyle(node.parentVisible);\n    }\n\n    connectedCallback(): void {\n        this.node.onPropertyChanged(this.onPropertyChanged);\n    }\n\n    disconnectedCallback(): void {\n        this.node.removePropertyChanged(this.onPropertyChanged);\n    }\n\n    private readonly onPropertyChanged = (property: keyof INode, model: INode) => {\n        if (property === \"visible\") {\n            setSVGIcon(this.visibleIcon, this.getVisibleIcon());\n        } else if (property === \"parentVisible\") {\n            this.setVisibleStyle(model[property]);\n        }\n    };\n\n    private setVisibleStyle(parentVisible?: boolean) {\n        if (parentVisible === true) {\n            this.visibleIcon.classList.remove(style[\"parent-hidden\"]);\n        } else {\n            this.visibleIcon.classList.add(style[\"parent-hidden\"]);\n        }\n    }\n\n    addSelectedStyle(style: string) {\n        this.getSelectedHandler().classList.add(style);\n    }\n\n    removeSelectedStyle(style: string) {\n        this.getSelectedHandler().classList.remove(style);\n    }\n\n    abstract getSelectedHandler(): HTMLElement;\n\n    dispose() {\n        this.remove();\n        this.node.removePropertyChanged(this.onPropertyChanged);\n        this.visibleIcon.removeEventListener(\"click\", this.onVisibleIconClick);\n        this.document = null as any;\n        this._node = null as any;\n    }\n\n    private getVisibleIcon() {\n        return this.node.visible ? \"icon-eye\" : \"icon-eye-slash\";\n    }\n\n    private readonly onVisibleIconClick = (e: MouseEvent) => {\n        e.stopPropagation();\n        Transaction.execute(this.document, \"change visible\", () => {\n            this.node.visible = !this.node.visible;\n        });\n        this.document.visual.update();\n    };\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, setSVGIcon, svg } from \"chili-controls\";\nimport { IDocument, INodeLinkedList } from \"chili-core\";\nimport { TreeItem } from \"./treeItem\";\nimport style from \"./treeItemGroup.module.css\";\n\nexport class TreeGroup extends TreeItem {\n    private _isExpanded = true;\n    readonly header: HTMLElement;\n    readonly items: HTMLDivElement = div({ className: `${style.container} ${style.left16px}` });\n    readonly expanderIcon: SVGSVGElement;\n\n    constructor(document: IDocument, node: INodeLinkedList) {\n        super(document, node);\n        this.expanderIcon = svg({\n            icon: this.getExpanderIcon(),\n            className: style.expanderIcon,\n            onclick: this.handleExpanderClick,\n        });\n        this.header = div(\n            { className: `${style.row} ${style.header}` },\n            this.expanderIcon,\n            this.name,\n            this.visibleIcon,\n        );\n        super.append(div({ className: style.container }, this.header, this.items));\n    }\n\n    get isExpanded(): boolean {\n        return this._isExpanded;\n    }\n\n    set isExpanded(value: boolean) {\n        this._isExpanded = value;\n        setSVGIcon(this.expanderIcon, this.getExpanderIcon());\n        this.items.classList.toggle(style.hide, !this._isExpanded);\n    }\n\n    getSelectedHandler(): HTMLElement {\n        return this.header;\n    }\n\n    override dispose() {\n        super.dispose();\n        this.header.remove();\n        this.expanderIcon.removeEventListener(\"click\", this.handleExpanderClick);\n    }\n\n    private readonly handleExpanderClick = (e: MouseEvent) => {\n        e.stopPropagation();\n        this.isExpanded = !this._isExpanded;\n    };\n\n    private getExpanderIcon() {\n        return this._isExpanded ? \"icon-angle-down\" : \"icon-angle-right\";\n    }\n\n    override appendChild<T extends Node>(node: T): T {\n        this.items.appendChild(node);\n        return node;\n    }\n\n    override append(...nodes: Node[]): void {\n        this.items.append(...nodes);\n    }\n\n    override removeChild<T extends Node>(child: T): T {\n        if (child.parentNode === this.items) this.items.removeChild(child);\n        return child;\n    }\n\n    addItem(...items: Node[]) {\n        this.items.append(...items);\n        return this;\n    }\n\n    insertAfter(item: TreeItem, child: TreeItem | null): void {\n        const referenceNode = child ? child.nextSibling : this.items.firstChild;\n        this.items.insertBefore(item, referenceNode);\n    }\n}\n\ncustomElements.define(\"tree-group\", TreeGroup);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { a, svg } from \"chili-controls\";\nimport { I18n, I18nKeys, INode, PubSub } from \"chili-core\";\nimport { ProjectView } from \"./projectView\";\nimport style from \"./toolBar.module.css\";\nimport { Tree } from \"./tree\";\nimport { TreeGroup } from \"./tree/treeItemGroup\";\n\nexport class ToolBar extends HTMLElement {\n    constructor(readonly projectView: ProjectView) {\n        super();\n        this.className = style.panel;\n        this.render();\n    }\n\n    private render() {\n        const buttons = [\n            { icon: \"icon-folder-plus\", tip: \"items.tool.newFolder\", command: this.newGroup },\n            { icon: \"icon-unexpand\", tip: \"items.tool.unexpandAll\", command: this.unExpandAll },\n            { icon: \"icon-expand\", tip: \"items.tool.expandAll\", command: this.expandAll },\n        ];\n        buttons.forEach(({ icon, tip, command }) => this.button(icon, tip as I18nKeys, command));\n    }\n\n    private button(icon: string, tip: I18nKeys, command: () => void) {\n        this.append(\n            a(\n                { title: I18n.translate(tip) },\n                svg({\n                    icon,\n                    className: style.svg,\n                    onclick: command,\n                }),\n            ),\n        );\n    }\n\n    private readonly newGroup = () => {\n        PubSub.default.pub(\"executeCommand\", \"create.folder\");\n    };\n\n    private readonly expandAll = () => {\n        this.setExpand(true);\n    };\n\n    private readonly unExpandAll = () => {\n        this.setExpand(false);\n    };\n\n    private setExpand(expand: boolean) {\n        let tree = this.projectView.activeTree();\n        if (!tree) return;\n        let first = this.projectView.activeDocument?.rootNode.firstChild;\n        if (first) this.setNodeExpand(tree, first, expand);\n    }\n\n    private setNodeExpand(tree: Tree, list: INode, expand: boolean) {\n        let item = tree.treeItem(list);\n        if (item instanceof TreeGroup) {\n            item.isExpanded = expand;\n        }\n        if (INode.isLinkedListNode(list) && list.firstChild) {\n            this.setNodeExpand(tree, list.firstChild, expand);\n        }\n        if (list.nextSibling) {\n            this.setNodeExpand(tree, list.nextSibling, expand);\n        }\n    }\n}\n\ncustomElements.define(\"chili-toolbar\", ToolBar);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { IDocument, INode } from \"chili-core\";\nimport { TreeItem } from \"./treeItem\";\nimport style from \"./treeModel.module.css\";\n\nexport class TreeModel extends TreeItem {\n    constructor(document: IDocument, node: INode) {\n        super(document, node);\n        this.append(this.name, this.visibleIcon);\n        this.classList.add(style.panel);\n    }\n\n    getSelectedHandler(): HTMLElement {\n        return this;\n    }\n}\n\ncustomElements.define(\"tree-model\", TreeModel);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport {\n    IDocument,\n    INode,\n    INodeChangedObserver,\n    INodeLinkedList,\n    NodeRecord,\n    PubSub,\n    ShapeType,\n    Transaction,\n    VisualNode,\n} from \"chili-core\";\nimport { NodeSelectionHandler, ShapeSelectionHandler } from \"chili-vis\";\nimport style from \"./tree.module.css\";\nimport { TreeItem } from \"./treeItem\";\nimport { TreeGroup } from \"./treeItemGroup\";\nimport { TreeModel } from \"./treeModel\";\n\nexport class Tree extends HTMLElement implements INodeChangedObserver {\n    private readonly nodeMap = new Map<INode, TreeItem>();\n    private lastClicked: INode | undefined;\n    private readonly selectedNodes: Set<INode> = new Set();\n    private dragging: INode[] | undefined;\n\n    constructor(private document: IDocument) {\n        super();\n        this.className = style.panel;\n        this.initializeTree(document);\n    }\n\n    private initializeTree(document: IDocument) {\n        this.addAllNodes(document, this, document.rootNode);\n        this.addEvents(this);\n    }\n\n    connectedCallback() {\n        this.document.addNodeObserver(this);\n        PubSub.default.sub(\"selectionChanged\", this.handleSelectionChanged);\n    }\n\n    disconnectedCallback() {\n        this.document.removeNodeObserver(this);\n        PubSub.default.remove(\"selectionChanged\", this.handleSelectionChanged);\n    }\n\n    treeItem(node: INode): TreeItem | undefined {\n        return this.nodeMap.get(node);\n    }\n\n    dispose(): void {\n        this.lastClicked = undefined;\n        this.dragging = undefined;\n        this.nodeMap.forEach((x) => x.dispose());\n        this.nodeMap.clear();\n        this.selectedNodes.clear();\n        this.removeEvents(this);\n        this.document.removeNodeObserver(this);\n        PubSub.default.remove(\"selectionChanged\", this.handleSelectionChanged);\n        this.document = null as any;\n    }\n\n    handleNodeChanged(records: NodeRecord[]) {\n        this.ensureHasHTML(records);\n        records.forEach((record) => {\n            const ele = this.nodeMap.get(record.node);\n            ele?.remove();\n            if (!ele || !record.newParent) return;\n\n            let parent = this.nodeMap.get(record.newParent) || this.createAndMapParent(record.newParent);\n            if (parent instanceof TreeGroup) {\n                const pre = record.newPrevious ? this.nodeMap.get(record.newPrevious) : null;\n                parent.insertAfter(ele, pre ?? null);\n            }\n        });\n    }\n\n    private createAndMapParent(newParent: INode) {\n        const parent = this.createHTMLElement(this.document, newParent);\n        this.nodeMap.set(newParent, parent);\n        return parent;\n    }\n\n    private readonly handleSelectionChanged = (\n        document: IDocument,\n        selected: INode[],\n        unselected: INode[],\n    ) => {\n        unselected.forEach((x) => {\n            this.nodeMap.get(x)?.removeSelectedStyle(style.selected);\n            this.selectedNodes.delete(x);\n        });\n        this.setLastClickItem(undefined);\n        selected.forEach((model) => {\n            this.selectedNodes.add(model);\n            this.nodeMap.get(model)?.addSelectedStyle(style.selected);\n        });\n        this.scrollToNode(selected);\n    };\n\n    private ensureHasHTML(records: NodeRecord[]) {\n        records.forEach((record) => {\n            if (!this.nodeMap.has(record.node)) {\n                this.nodeMap.set(record.node, this.createHTMLElement(this.document, record.node));\n            }\n        });\n    }\n\n    private scrollToNode(selected: INode[]) {\n        const node = selected.at(0);\n        if (node) {\n            this.expandParents(node);\n            this.nodeMap.get(node)?.scrollIntoView({ block: \"nearest\", behavior: \"smooth\" });\n        }\n    }\n\n    private expandParents(node: INode) {\n        let parent = node.parent;\n        while (parent) {\n            const group = this.nodeMap.get(parent) as TreeGroup;\n            if (group && !group.isExpanded) {\n                group.isExpanded = true;\n            }\n            parent = parent.parent;\n        }\n    }\n\n    private addAllNodes(document: IDocument, parent: HTMLElement, node: INode) {\n        const element = this.createHTMLElement(document, node);\n        this.nodeMap.set(node, element);\n        parent.appendChild(element);\n\n        const firstChild = (node as INodeLinkedList).firstChild;\n        if (firstChild) this.addAllNodes(document, element, firstChild);\n        if (node.nextSibling) this.addAllNodes(document, parent, node.nextSibling);\n    }\n\n    private createHTMLElement(document: IDocument, node: INode): TreeItem {\n        let result: TreeItem;\n        if (INode.isLinkedListNode(node)) result = new TreeGroup(document, node);\n        else if (node instanceof VisualNode) result = new TreeModel(document, node);\n        else throw new Error(\"unknown node\");\n        return result;\n    }\n\n    private addEvents(item: HTMLElement) {\n        item.addEventListener(\"dragstart\", this.onDragStart);\n        item.addEventListener(\"dragover\", this.onDragOver);\n        item.addEventListener(\"dragleave\", this.onDragLeave);\n        item.addEventListener(\"drop\", this.onDrop);\n        item.addEventListener(\"click\", this.onClick);\n    }\n\n    private removeEvents(item: HTMLElement) {\n        item.removeEventListener(\"dragstart\", this.onDragStart);\n        item.removeEventListener(\"dragover\", this.onDragOver);\n        item.removeEventListener(\"dragleave\", this.onDragLeave);\n        item.removeEventListener(\"drop\", this.onDrop);\n        item.removeEventListener(\"click\", this.onClick);\n    }\n\n    private getTreeItem(item: HTMLElement | null): TreeItem | undefined {\n        if (item === null) return undefined;\n        if (item instanceof TreeItem) return item;\n        return this.getTreeItem(item.parentElement);\n    }\n\n    private readonly onClick = (event: MouseEvent) => {\n        if (!this.canSelect()) return;\n\n        const item = this.getTreeItem(event.target as HTMLElement)?.node;\n        if (!item) return;\n        event.stopPropagation();\n\n        if (event.shiftKey) {\n            this.handleShiftClick(item);\n        } else {\n            this.document.selection.setSelection([item], event.ctrlKey);\n        }\n\n        this.setLastClickItem(item);\n    };\n\n    private handleShiftClick(item: INode) {\n        if (this.lastClicked) {\n            const nodes = INode.getNodesBetween(this.lastClicked, item);\n            this.document.selection.setSelection(nodes, false);\n        }\n    }\n\n    private readonly onDragLeave = (event: DragEvent) => {\n        if (!this.canDrop(event)) return;\n    };\n\n    private readonly onDragOver = (event: DragEvent) => {\n        if (!this.canDrop(event)) {\n            return;\n        }\n        event.preventDefault();\n        event.dataTransfer!.dropEffect = \"move\";\n    };\n\n    private canSelect() {\n        if (this.document.visual.eventHandler instanceof NodeSelectionHandler) {\n            return true;\n        }\n\n        if (this.document.visual.eventHandler instanceof ShapeSelectionHandler) {\n            return this.document.visual.eventHandler.shapeType === ShapeType.Shape;\n        }\n\n        return false;\n    }\n\n    private setLastClickItem(item: INode | undefined) {\n        if (this.lastClicked !== undefined) {\n            this.nodeMap.get(this.lastClicked)?.removeSelectedStyle(style.current);\n        }\n        this.lastClicked = item;\n        if (item !== undefined) {\n            this.nodeMap.get(item)?.addSelectedStyle(style.current);\n            this.document.currentNode = INode.isLinkedListNode(item) ? item : item.parent;\n        }\n    }\n\n    private canDrop(event: DragEvent) {\n        let node = this.getTreeItem(event.target as HTMLElement)?.node;\n        if (node === undefined) return false;\n        if (this.dragging?.includes(node)) return false;\n        let parent = node.parent;\n        while (parent !== undefined) {\n            if (this.dragging?.includes(parent)) return false;\n            parent = parent.parent;\n        }\n        return true;\n    }\n\n    protected onDrop = (event: DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        let node = this.getTreeItem(event.target as HTMLElement)?.node;\n        if (node === undefined) return;\n        Transaction.execute(this.document, \"move node\", () => {\n            let isLinkList = INode.isLinkedListNode(node);\n            let newParent = isLinkList ? (node as INodeLinkedList) : node.parent;\n            let target = isLinkList ? undefined : node;\n            this.dragging?.forEach((x) => {\n                x.parent?.move(x, newParent!, target);\n            });\n            this.dragging = undefined;\n        });\n    };\n\n    private readonly onDragStart = (event: DragEvent) => {\n        event.stopPropagation();\n        const item = this.getTreeItem(event.target as HTMLElement)?.node;\n        this.dragging = INode.findTopLevelNodes(this.selectedNodes);\n        if (item && !INode.containsDescendant(this.selectedNodes, item)) {\n            this.dragging.push(item);\n        }\n    };\n}\n\ncustomElements.define(\"ui-tree\", Tree);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, span } from \"chili-controls\";\nimport { IDocument, IView, Localize, PubSub } from \"chili-core\";\nimport style from \"./projectView.module.css\";\nimport { ToolBar } from \"./toolBar\";\nimport { Tree } from \"./tree\";\n\nexport class ProjectView extends HTMLElement {\n    private readonly _documentTreeMap = new Map<IDocument, Tree>();\n\n    private _activeDocument: IDocument | undefined;\n    get activeDocument() {\n        return this._activeDocument;\n    }\n\n    private readonly panel: HTMLDivElement;\n\n    constructor(props: { className: string }) {\n        super();\n        this.classList.add(style.root, props.className);\n        this.panel = div({\n            className: style.itemsPanel,\n        });\n        PubSub.default.sub(\"activeViewChanged\", this.handleActiveViewChanged);\n        PubSub.default.sub(\"documentClosed\", this.handleDocumentClosed);\n\n        this.render();\n    }\n\n    private render() {\n        this.append(\n            div(\n                { className: style.headerPanel },\n                span({\n                    className: style.header,\n                    textContent: new Localize(\"items.header\"),\n                }),\n                new ToolBar(this),\n            ),\n            this.panel,\n        );\n    }\n\n    activeTree() {\n        if (!this._activeDocument) return undefined;\n        return this._documentTreeMap.get(this._activeDocument);\n    }\n\n    private readonly handleDocumentClosed = (document: IDocument) => {\n        const tree = this._documentTreeMap.get(document);\n        if (tree) {\n            tree.remove();\n            tree.dispose();\n            this._documentTreeMap.delete(document);\n        }\n    };\n\n    private readonly handleActiveViewChanged = (view: IView | undefined) => {\n        if (this._activeDocument === view?.document) return;\n\n        this._documentTreeMap.get(this._activeDocument!)?.remove();\n        this._activeDocument = view?.document;\n\n        if (view) {\n            let tree = this._documentTreeMap.get(view.document);\n            if (!tree) {\n                tree = new Tree(view.document);\n                this._documentTreeMap.set(view.document, tree);\n            }\n            this.panel.append(tree);\n        }\n    };\n}\n\ncustomElements.define(\"chili-project-view\", ProjectView);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport style from \"./propertyBase.module.css\";\n\nexport abstract class PropertyBase extends HTMLElement {\n    constructor(readonly objects: any[]) {\n        super();\n        this.className = style.panel;\n        if (objects.length === 0) {\n            throw new Error(`there are no objects`);\n        }\n    }\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport {\n    div,\n    input,\n    NumberConverter,\n    span,\n    StringConverter,\n    XYConverter,\n    XYZConverter,\n} from \"chili-controls\";\nimport {\n    Binding,\n    IConverter,\n    IDocument,\n    isPropertyChanged,\n    Localize,\n    Property,\n    PubSub,\n    Result,\n    Transaction,\n    XY,\n    XYZ,\n} from \"chili-core\";\nimport commonStyle from \"./common.module.css\";\nimport style from \"./input.module.css\";\nimport { PropertyBase } from \"./propertyBase\";\n\nclass ArrayValueConverter implements IConverter {\n    constructor(\n        readonly objects: any[],\n        readonly property: Property,\n        readonly converter?: IConverter,\n    ) {}\n\n    convert(value: any): Result<string> {\n        return Result.ok(this.getDefaultValue());\n    }\n\n    convertBack?(value: string): Result<any> {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    private getValueString(obj: any): string {\n        const value = obj[this.property.name];\n        const cvalue = this.converter?.convert(value);\n        return cvalue?.isOk ? cvalue.value : String(value);\n    }\n\n    private getDefaultValue() {\n        const values = this.objects.map(this.getValueString.bind(this));\n        const uniqueValues = new Set(values);\n        return uniqueValues.size === 1 ? values[0] : \"\";\n    }\n}\n\nexport class InputProperty extends PropertyBase {\n    readonly converter: IConverter | undefined;\n\n    constructor(\n        readonly document: IDocument,\n        objects: any[],\n        readonly property: Property,\n        converter?: IConverter,\n    ) {\n        super(objects);\n        this.converter = converter ?? this.getConverter();\n        const arrayConverter = new ArrayValueConverter(objects, property, this.converter);\n        this.append(\n            div(\n                { className: commonStyle.panel },\n                span({ className: commonStyle.propertyName, textContent: new Localize(property.display) }),\n                input({\n                    className: style.box,\n                    value: new Binding(objects[0], property.name, arrayConverter),\n                    readOnly: this.isReadOnly(),\n                    onkeydown: this.handleKeyDown,\n                    onblur: this.handleBlur,\n                }),\n            ),\n        );\n    }\n\n    private isReadOnly(): boolean {\n        let des = Object.getOwnPropertyDescriptor(this.objects[0], this.property.name);\n        if (!des) {\n            let proto = Object.getPrototypeOf(this.objects[0]);\n            while (isPropertyChanged(proto)) {\n                des = Object.getOwnPropertyDescriptor(proto, this.property.name);\n                if (des) break;\n                proto = Object.getPrototypeOf(proto);\n            }\n        }\n        return (\n            des?.set === undefined ||\n            (this.converter === undefined && typeof this.objects[0][this.property.name] !== \"string\")\n        );\n    }\n\n    private readonly handleBlur = (e: FocusEvent) => {\n        this.setValue(e.target as HTMLInputElement);\n    };\n\n    private readonly handleKeyDown = (e: KeyboardEvent) => {\n        e.stopPropagation();\n        if (this.converter && e.key === \"Enter\") {\n            this.setValue(e.target as HTMLInputElement);\n        }\n    };\n\n    private readonly setValue = (input: HTMLInputElement) => {\n        if (this.isReadOnly()) return;\n\n        const newValue = this.converter?.convertBack?.(input.value);\n        if (!newValue?.isOk) {\n            PubSub.default.pub(\"showToast\", \"error.default:{0}\", newValue?.error);\n            return;\n        }\n        Transaction.execute(this.document, \"modify property\", () => {\n            this.objects.forEach((x) => {\n                x[this.property.name] = newValue.value;\n            });\n            this.document.visual.update();\n        });\n    };\n\n    private getConverter(): IConverter | undefined {\n        const name = this.objects[0][this.property.name].constructor.name;\n        const converters: { [key: string]: () => IConverter } = {\n            [XYZ.name]: () => new XYZConverter(),\n            [XY.name]: () => new XYConverter(),\n            [String.name]: () => new StringConverter(),\n            [Number.name]: () => new NumberConverter(),\n        };\n        return converters[name]?.();\n    }\n}\n\ncustomElements.define(\"chili-input-property\", InputProperty);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { GroupNode, IConverter, IDocument, Matrix4, Result, VisualNode, XYZLike } from \"chili-core\";\nimport { InputProperty } from \"./input\";\nimport { PropertyBase } from \"./propertyBase\";\n\nexport class MatrixProperty extends PropertyBase {\n    readonly first: VisualNode | GroupNode;\n\n    constructor(\n        readonly document: IDocument,\n        geometries: (VisualNode | GroupNode)[],\n        className: string,\n    ) {\n        super(geometries);\n        this.first = geometries[0];\n        this.className = className;\n        this.append(\n            new InputProperty(\n                document,\n                [this.first],\n                {\n                    name: \"transform\",\n                    display: \"transform.translation\",\n                },\n                new TranslationConverter(this.first),\n            ),\n            new InputProperty(\n                document,\n                [this.first],\n                {\n                    name: \"transform\",\n                    display: \"transform.scale\",\n                },\n                new ScalingConverter(this.first),\n            ),\n            new InputProperty(\n                document,\n                [this.first],\n                {\n                    name: \"transform\",\n                    display: \"transform.rotation\",\n                },\n                new RotateConverter(this.first),\n            ),\n        );\n    }\n\n    private readonly onPropertyChanged = (property: keyof (VisualNode | GroupNode)) => {\n        if (property === \"transform\") {\n            this.objects.forEach((obj) => {\n                if (obj === this.first) return;\n                obj.transform = this.first.transform;\n            });\n        }\n    };\n\n    connectedCallback() {\n        (this.first as VisualNode).onPropertyChanged(this.onPropertyChanged);\n    }\n\n    disconnectedCallback() {\n        (this.first as VisualNode).removePropertyChanged(this.onPropertyChanged);\n    }\n}\n\ncustomElements.define(\"matrix-property\", MatrixProperty);\n\nexport abstract class MatrixConverter implements IConverter<Matrix4, string> {\n    constructor(readonly geometry: VisualNode | GroupNode) {}\n\n    convert(value: Matrix4): Result<string, string> {\n        const [x, y, z] = this.convertFrom(value);\n        return Result.ok(`${x.toFixed(6)}, ${y.toFixed(6)}, ${z.toFixed(6)}`);\n    }\n\n    protected abstract convertFrom(value: Matrix4): [number, number, number];\n    protected abstract convertTo(values: XYZLike): Matrix4;\n\n    convertBack(value: string): Result<Matrix4, string> {\n        const values = value\n            .split(\",\")\n            .map(Number)\n            .filter((x) => !isNaN(x));\n        if (values.length !== 3) return Result.err(\"invalid number of values\");\n        const newValue = {\n            x: values[0],\n            y: values[1],\n            z: values[2],\n        };\n        const matrix = this.convertTo(newValue);\n        return Result.ok(matrix);\n    }\n}\n\nexport class TranslationConverter extends MatrixConverter {\n    protected convertFrom(matrix: Matrix4): [number, number, number] {\n        let position = matrix.translationPart();\n        return [position.x, position.y, position.z];\n    }\n    protected convertTo(values: XYZLike): Matrix4 {\n        const rotation = this.geometry.transform.getEulerAngles();\n        const scale = this.geometry.transform.getScale();\n        return Matrix4.createFromTRS(values, rotation, scale);\n    }\n}\n\nexport class ScalingConverter extends MatrixConverter {\n    protected convertFrom(matrix: Matrix4): [number, number, number] {\n        let s = matrix.getScale();\n        return [s.x, s.y, s.z];\n    }\n    protected convertTo(values: XYZLike): Matrix4 {\n        const rotation = this.geometry.transform.getEulerAngles();\n        const translation = this.geometry.transform.translationPart();\n        return Matrix4.createFromTRS(translation, rotation, values);\n    }\n}\n\nexport class RotateConverter extends MatrixConverter {\n    protected convertFrom(matrix: Matrix4): [number, number, number] {\n        let s = matrix.getEulerAngles();\n        return [(s.pitch * 180) / Math.PI, (s.yaw * 180) / Math.PI, (s.roll * 180) / Math.PI];\n    }\n    protected convertTo(values: XYZLike): Matrix4 {\n        const scale = this.geometry.transform.getScale();\n        const translation = this.geometry.transform.translationPart();\n        return Matrix4.createFromTRS(\n            translation,\n            {\n                pitch: (values.x * Math.PI) / 180,\n                yaw: (values.y * Math.PI) / 180,\n                roll: (values.z * Math.PI) / 180,\n            },\n            scale,\n        );\n    }\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, input, span } from \"chili-controls\";\nimport { Binding, IDocument, Localize, Property, Transaction } from \"chili-core\";\nimport commonStyle from \"./common.module.css\";\nimport { PropertyBase } from \"./propertyBase\";\n\nexport class CheckProperty extends PropertyBase {\n    constructor(\n        readonly document: IDocument,\n        objects: any[],\n        readonly property: Property,\n    ) {\n        super(objects);\n        this.appendChild(\n            div(\n                { className: commonStyle.panel },\n                span({ className: commonStyle.propertyName, textContent: new Localize(property.display) }),\n                input({\n                    type: \"checkbox\",\n                    checked: new Binding(objects[0], property.name),\n                    onclick: () => {\n                        const value = !objects[0][property.name];\n\n                        Transaction.execute(document, \"modify property\", () => {\n                            objects.forEach((x) => {\n                                x[property.name] = value;\n                            });\n                            document.visual.update();\n                        });\n                    },\n                }),\n            ),\n        );\n    }\n}\n\ncustomElements.define(\"chili-check-property\", CheckProperty);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { ColorConverter, div, input, label } from \"chili-controls\";\nimport { Binding, IDocument, Localize, Property, PubSub, Transaction } from \"chili-core\";\nimport colorStyle from \"./colorPorperty.module.css\";\nimport commonStyle from \"./common.module.css\";\nimport { PropertyBase } from \"./propertyBase\";\n\nexport class ColorProperty extends PropertyBase {\n    readonly converter = new ColorConverter();\n    readonly input: HTMLInputElement;\n\n    constructor(\n        readonly document: IDocument,\n        objects: any[],\n        readonly property: Property,\n    ) {\n        super(objects);\n        this.input = this.createInput(objects[0]);\n        this.appendChild(this.createPanel());\n    }\n\n    private createInput(object: any): HTMLInputElement {\n        return input({\n            className: colorStyle.color,\n            type: \"color\",\n            value: new Binding(object, this.property.name, this.converter),\n            onchange: this.setColor,\n        });\n    }\n\n    private createPanel(): HTMLElement {\n        return div(\n            { className: commonStyle.panel },\n            label({\n                className: commonStyle.propertyName,\n                textContent: new Localize(this.property.display),\n            }),\n            this.input,\n        );\n    }\n\n    disconnectedCallback(): void {\n        this.input.removeEventListener(\"onchange\", this.setColor);\n    }\n\n    private readonly setColor = (e: Event) => {\n        const value = (e.target as HTMLInputElement).value;\n        const color = this.converter.convertBack(value).value;\n        if (color === undefined) {\n            PubSub.default.pub(\"showToast\", \"toast.converter.invalidColor\");\n            return;\n        }\n        Transaction.execute(this.document, \"change color\", () => {\n            this.objects.forEach((x) => {\n                x[this.property.name] = color;\n            });\n        });\n    };\n}\n\ncustomElements.define(\"chili-color-property\", ColorProperty);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, Expander, img, svg } from \"chili-controls\";\nimport { UrlStringConverter } from \"chili-controls/src/converters/urlConverter\";\nimport { I18nKeys, IDocument, PathBinding, Property, readFileAsync, Texture } from \"chili-core\";\nimport { findPropertyControl } from \"../utils\";\nimport style from \"./textureEditor.module.css\";\n\nexport class TextureProperty extends Expander {\n    constructor(\n        readonly document: IDocument,\n        display: I18nKeys,\n        readonly texture: Texture,\n    ) {\n        super(display);\n        this.classList.add(style.root);\n        this.append(this.render());\n    }\n\n    private render() {\n        const properties = Property.getProperties(this.texture)\n            .filter((x) => (x.name as keyof Texture) !== \"image\")\n            .map((x) => findPropertyControl(this.document, [this.texture], x));\n\n        return div(\n            { className: style.expander },\n            div({ className: style.properties }, ...properties),\n            div(\n                { className: style.image },\n                img({\n                    style: {\n                        backgroundImage: new PathBinding(this.texture, \"image\", new UrlStringConverter()),\n                        backgroundSize: \"contain\",\n                    },\n                    onclick: this.selectTexture,\n                }),\n                svg({\n                    icon: \"icon-times\",\n                    onclick: () => {\n                        this.texture.image = \"\";\n                    },\n                }),\n            ),\n        );\n    }\n\n    private readonly selectTexture = async () => {\n        let file = await readFileAsync(\".png, .jpg, .jpeg\", false, \"readAsDataURL\");\n        this.texture.image = file.value[0].data;\n    };\n}\n\ncustomElements.define(\"texture-editor\", TextureProperty);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { button, collection, ColorConverter, div, span, UrlStringConverter } from \"chili-controls\";\nimport {\n    Binding,\n    IDocument,\n    Localize,\n    Material,\n    ObservableCollection,\n    PathBinding,\n    Property,\n    PubSub,\n    Transaction,\n} from \"chili-core\";\nimport style from \"./materialProperty.module.css\";\nimport { PropertyBase } from \"./propertyBase\";\n\nexport class MaterialProperty extends PropertyBase {\n    private readonly materials: ObservableCollection<Material>;\n\n    constructor(\n        readonly document: IDocument,\n        objects: { materialId: string | string[] }[],\n        readonly property: Property,\n    ) {\n        super(objects);\n        this.materials = this.materialCollection(objects[0].materialId);\n        this.append(\n            collection({\n                sources: this.materials,\n                template: (material, index) => this.materialControl(document, material, index),\n            }),\n        );\n    }\n\n    private materialControl(document: IDocument, material: Material, index: number) {\n        return div(\n            { className: style.material },\n            div(\n                span({ textContent: new Localize(\"common.material\") }),\n                this.materials.length > 1 ? span({ textContent: ` ${index + 1}` }) : \"\",\n            ),\n            button({\n                textContent: material.name,\n                style: {\n                    backgroundColor: new Binding(material, \"color\", new ColorConverter()),\n                    backgroundImage: new PathBinding(material, \"map.image\", new UrlStringConverter()),\n                    backgroundBlendMode: \"multiply\",\n                    backgroundSize: \"cover\",\n                    cursor: \"pointer\",\n                },\n                onclick: (e) => {\n                    PubSub.default.pub(\"editMaterial\", document, material, (material) => {\n                        this.setMaterial(e, material, index);\n                    });\n                },\n            }),\n        );\n    }\n\n    private setMaterial(e: MouseEvent, material: Material, index: number) {\n        Transaction.execute(this.document, \"change material\", () => {\n            this.materials.replace(index, material);\n            this.objects.forEach((x) => {\n                if (this.property.name in x) {\n                    x.materialId =\n                        this.materials.length > 1\n                            ? x.materialId.toSpliced(index, 1, material.id)\n                            : material.id;\n                }\n            });\n        });\n        this.document.visual.update();\n    }\n\n    private materialCollection(id: string | string[]) {\n        const findMaterial = (id: string) => this.document.materials.find((m) => m.id === id);\n        const materials = Array.isArray(id)\n            ? id.map(findMaterial).filter(Boolean)\n            : [findMaterial(id)].filter(Boolean);\n        return new ObservableCollection(...materials) as ObservableCollection<Material>;\n    }\n}\n\ncustomElements.define(\"chili-material-property\", MaterialProperty);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { IConverter, IDocument, Logger, Property, Texture } from \"chili-core\";\nimport { CheckProperty } from \"./check\";\nimport { ColorProperty } from \"./colorProperty\";\nimport { InputProperty } from \"./input\";\nimport { TextureProperty } from \"./material/textureEditor\";\nimport { MaterialProperty } from \"./materialProperty\";\n\nexport function findPropertyControl(\n    document: IDocument,\n    objs: any[],\n    prop: Property,\n    converter?: IConverter,\n) {\n    if (prop === undefined || objs.length === 0) return \"\";\n\n    if (prop.type === \"color\") {\n        return new ColorProperty(document, objs, prop);\n    }\n\n    if (prop.type === \"materialId\" && canShowMaterialProperty(objs, prop)) {\n        return new MaterialProperty(document, objs, prop);\n    }\n\n    const value = objs[0][prop.name];\n    if (value instanceof Texture) {\n        return new TextureProperty(document, prop.display, value);\n    }\n\n    if ([\"object\", \"string\", \"number\"].includes(typeof value)) {\n        return new InputProperty(document, objs, prop, converter);\n    }\n\n    if (typeof value === \"boolean\") {\n        return new CheckProperty(document, objs, prop);\n    }\n\n    Logger.warn(`Property ${prop.name} not found in ${Object.getPrototypeOf(objs[0]).constructor.name}`);\n    return \"\";\n}\n\nfunction canShowMaterialProperty(objs: any[], prop: Property) {\n    if (objs.length === 0) return false;\n    if (objs.length === 1) return true;\n    return objs.every((obj) => obj[prop.name] === objs[0][prop.name]);\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, Expander, label } from \"chili-controls\";\nimport {\n    FolderNode,\n    GroupNode,\n    IDocument,\n    INode,\n    IView,\n    Localize,\n    Node,\n    Property,\n    PubSub,\n    VisualNode,\n} from \"chili-core\";\nimport { MatrixProperty } from \"./matrixProperty\";\nimport style from \"./propertyView.module.css\";\nimport { findPropertyControl } from \"./utils\";\n\nexport class PropertyView extends HTMLElement {\n    private readonly panel = div({ className: style.panel });\n\n    constructor(props: { className: string }) {\n        super();\n        this.classList.add(props.className, style.root);\n        this.append(\n            label({\n                className: style.header,\n                textContent: new Localize(\"properties.header\"),\n            }),\n            this.panel,\n        );\n        PubSub.default.sub(\"showProperties\", this.handleShowProperties);\n        PubSub.default.sub(\"activeViewChanged\", this.handleActiveViewChanged);\n    }\n\n    private readonly handleActiveViewChanged = (view: IView | undefined) => {\n        if (view) {\n            let nodes = view.document.selection.getSelectedNodes();\n            this.handleShowProperties(view.document, nodes);\n        }\n    };\n\n    private readonly handleShowProperties = (document: IDocument, nodes: INode[]) => {\n        this.removeProperties();\n        if (nodes.length === 0) return;\n        this.addModel(document, nodes);\n        this.addGeometry(nodes, document);\n    };\n\n    private removeProperties() {\n        while (this.panel.lastElementChild) {\n            this.panel.removeChild(this.panel.lastElementChild);\n        }\n    }\n\n    private addModel(document: IDocument, nodes: INode[]) {\n        if (nodes.length === 0) return;\n\n        let controls: (HTMLElement | string)[] = [];\n        if (nodes[0] instanceof FolderNode) {\n            controls = Property.getProperties(Object.getPrototypeOf(nodes[0])).map((x) =>\n                findPropertyControl(document, nodes, x),\n            );\n        } else if (nodes[0] instanceof Node) {\n            controls = Property.getOwnProperties(Node.prototype).map((x) =>\n                findPropertyControl(document, nodes, x),\n            );\n        }\n\n        this.panel.append(div({ className: style.properties }, ...controls));\n    }\n\n    private addGeometry(nodes: INode[], document: IDocument) {\n        const geometries = nodes.filter((x) => x instanceof VisualNode || x instanceof GroupNode);\n        if (geometries.length === 0 || !this.isAllElementsOfTypeFirstElement(geometries)) return;\n        this.addTransform(document, geometries);\n        this.addParameters(geometries, document);\n    }\n\n    private addTransform(document: IDocument, geometries: (VisualNode | GroupNode)[]) {\n        const matrix = new Expander(\"common.matrix\");\n        this.panel.append(matrix);\n\n        matrix.contenxtPanel.append(new MatrixProperty(document, geometries, style.properties));\n    }\n\n    private addParameters(geometries: (VisualNode | GroupNode)[], document: IDocument) {\n        const entities = geometries.filter((x) => x instanceof VisualNode);\n        if (entities.length === 0 || !this.isAllElementsOfTypeFirstElement(entities)) return;\n        const parameters = new Expander(entities[0].display());\n        parameters.contenxtPanel.append(\n            ...Property.getProperties(Object.getPrototypeOf(entities[0]), Node.prototype).map((x) =>\n                findPropertyControl(document, entities, x),\n            ),\n        );\n        this.panel.append(parameters);\n    }\n\n    private isAllElementsOfTypeFirstElement(arr: any[]): boolean {\n        if (arr.length <= 1) {\n            return true;\n        }\n        const firstElementType = Object.getPrototypeOf(arr[0]).constructor;\n        for (let i = 1; i < arr.length; i++) {\n            if (Object.getPrototypeOf(arr[i]).constructor !== firstElementType) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\n\ncustomElements.define(\"chili-property-view\", PropertyView);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { IDocument, Material, Observable } from \"chili-core\";\n\nlet count = 1;\n\nexport class MaterialDataContent extends Observable {\n    get editingMaterial(): Material {\n        return this.getPrivateValue(\"editingMaterial\");\n    }\n    set editingMaterial(value: Material) {\n        this.setProperty(\"editingMaterial\", value);\n    }\n\n    constructor(\n        readonly document: IDocument,\n        readonly callback: (material: Material) => void,\n        editingMaterial: Material,\n    ) {\n        super();\n        this.setPrivateValue(\"editingMaterial\", editingMaterial);\n    }\n\n    deleteMaterial() {\n        if (this.document.materials.length <= 1) return;\n        let tempMaterial = this.editingMaterial;\n        this.editingMaterial = this.document.materials.find((m) => m.id !== this.editingMaterial.id)!;\n        this.callback(this.editingMaterial);\n        this.document.materials.remove(tempMaterial);\n    }\n\n    addMaterial() {\n        this.document.materials.push(new Material(this.document, `Material ${count++}`, 0xdddddd));\n    }\n\n    copyMaterial() {\n        this.document.materials.push(this.editingMaterial.clone());\n    }\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { button, collection, ColorConverter, div, span, svg } from \"chili-controls\";\nimport { UrlStringConverter } from \"chili-controls/src/converters/urlConverter\";\nimport {\n    Binding,\n    IConverter,\n    Localize,\n    Material,\n    PathBinding,\n    Property,\n    PubSub,\n    Result,\n    Texture,\n} from \"chili-core\";\nimport { findPropertyControl } from \"../utils\";\nimport { MaterialDataContent } from \"./materialDataContent\";\nimport style from \"./materialEditor.module.css\";\n\nclass ActiveStyleConverter implements IConverter<Material> {\n    constructor(readonly material: Material) {}\n\n    convert(value: Material): Result<string> {\n        return Result.ok(this.material === value ? `${style.material} ${style.active}` : style.material);\n    }\n}\n\nexport class MaterialEditor extends HTMLElement {\n    private readonly editingControl: HTMLElement;\n    private readonly colorConverter = new ColorConverter();\n\n    constructor(readonly dataContent: MaterialDataContent) {\n        super();\n        this.editingControl = div({ className: style.properties });\n        this.initEditingControl(dataContent.editingMaterial);\n        this.append(this.createEditorUI());\n    }\n\n    private createEditorUI() {\n        return div(\n            { className: style.root },\n            this.titleSection(),\n            this.materialsCollection(),\n            this.editingControl,\n            this.buttons(),\n        );\n    }\n\n    private titleSection() {\n        return div(\n            { className: style.title },\n            span({ textContent: new Localize(\"common.material\") }),\n            this.iconButton(\"icon-plus\", () => this.dataContent.addMaterial()),\n            this.iconButton(\"icon-clone\", () => this.dataContent.copyMaterial()),\n            this.iconButton(\"icon-trash\", () => this.dataContent.deleteMaterial()),\n        );\n    }\n\n    private iconButton(icon: string, onclick: () => void) {\n        return svg({ icon, onclick });\n    }\n\n    private materialsCollection() {\n        return collection({\n            className: style.materials,\n            sources: this.dataContent.document.materials,\n            template: (material: Material) => this.material(material),\n        });\n    }\n\n    private material(material: Material) {\n        return span({\n            className: new Binding(this.dataContent, \"editingMaterial\", new ActiveStyleConverter(material)),\n            title: material.name,\n            style: {\n                backgroundColor: new Binding(material, \"color\", this.colorConverter),\n                backgroundImage: new PathBinding(material, \"map.image\", new UrlStringConverter()),\n                backgroundBlendMode: \"multiply\",\n                backgroundSize: \"contain\",\n            },\n            onclick: () => {\n                this.dataContent.editingMaterial = material;\n            },\n            ondblclick: () => {\n                this.dataContent.callback(material);\n                this.remove();\n            },\n        });\n    }\n\n    private buttons() {\n        return div(\n            { className: style.bottom },\n            button({\n                textContent: new Localize(\"common.confirm\"),\n                onclick: () => {\n                    this.dataContent.callback(this.dataContent.editingMaterial);\n                    this.remove();\n                },\n            }),\n            button({\n                textContent: new Localize(\"common.cancel\"),\n                onclick: () => this.remove(),\n            }),\n        );\n    }\n\n    connectedCallback() {\n        this.dataContent.onPropertyChanged(this._onEditingMaterialChanged);\n        PubSub.default.sub(\"showProperties\", this._handleShowProperty);\n    }\n\n    disconnectedCallback() {\n        PubSub.default.remove(\"showProperties\", this._handleShowProperty);\n    }\n\n    private readonly _handleShowProperty = () => {\n        this.remove();\n    };\n\n    private readonly _onEditingMaterialChanged = (property: keyof MaterialDataContent) => {\n        if (property !== \"editingMaterial\") return;\n        this.editingControl.firstChild?.remove();\n        this.initEditingControl(this.dataContent.editingMaterial);\n    };\n\n    private initEditingControl(material: Material) {\n        this.editingControl.innerHTML = \"\";\n\n        const isTexture = (p: Property) => {\n            return (material as any)[p.name] instanceof Texture;\n        };\n\n        let properties = Property.getProperties(material);\n        this.editingControl.append(\n            ...properties\n                .filter((x) => !isTexture(x))\n                .map((x) => findPropertyControl(this.dataContent.document, [material], x)),\n            ...properties\n                .filter(isTexture)\n                .map((x) => findPropertyControl(this.dataContent.document, [material], x)),\n        );\n    }\n}\n\ncustomElements.define(\"material-editor\", MaterialEditor);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { MultistepCommand } from \"chili\";\nimport {\n    button,\n    ColorConverter,\n    div,\n    input,\n    label,\n    option,\n    select,\n    svg,\n    UrlStringConverter,\n} from \"chili-controls\";\nimport {\n    Binding,\n    CancelableCommand,\n    Combobox,\n    Command,\n    I18n,\n    I18nKeys,\n    ICommand,\n    IDisposable,\n    Localize,\n    Observable,\n    PathBinding,\n    Property,\n    PubSub,\n} from \"chili-core\";\nimport style from \"./commandContext.module.css\";\n\nexport class CommandContext extends HTMLElement implements IDisposable {\n    private readonly propMap: Map<string | number | symbol, [Property, HTMLElement][]> = new Map();\n\n    constructor(readonly command: ICommand) {\n        super();\n        this.className = style.panel;\n        let data = Command.getData(command);\n        this.append(\n            svg({ className: style.icon, icon: data!.icon }),\n            label({ className: style.title, textContent: new Localize(`command.${data!.key}`) }, `: `),\n        );\n        this.initContext();\n    }\n\n    connectedCallback(): void {\n        if (this.command instanceof Observable) {\n            this.command.onPropertyChanged(this.onPropertyChanged);\n        }\n    }\n\n    disconnectedCallback(): void {\n        if (this.command instanceof Observable) {\n            this.command.removePropertyChanged(this.onPropertyChanged);\n        }\n    }\n\n    dispose() {\n        this.propMap.clear();\n    }\n\n    private readonly onPropertyChanged = (property: string | number | symbol) => {\n        if (this.propMap.has(property)) {\n            const items = this.propMap.get(property)!;\n            for (const [prop, control] of items) {\n                this.setVisible(control, prop);\n            }\n        }\n    };\n\n    private initContext() {\n        const groupMap = new Map<I18nKeys, HTMLDivElement>();\n        Property.getProperties(this.command).forEach((property) => {\n            const group = this.findGroup(groupMap, property);\n            const item = this.createItem(this.command, property);\n            this.setVisible(item, property);\n            this.cacheDependencies(item, property);\n            group.append(item);\n        });\n    }\n\n    private cacheDependencies(item: HTMLElement, g: Property) {\n        if (g.dependencies) {\n            for (const d of g.dependencies) {\n                const items = this.propMap.get(d.property);\n                this.propMap.set(d.property, [...(items ?? []), [g, item]]);\n            }\n        }\n    }\n\n    private setVisible(control: HTMLElement, property: Property) {\n        let visible = true;\n        if (property.dependencies) {\n            for (const d of property.dependencies) {\n                if ((this.command as any)[d.property] !== d.value) {\n                    visible = false;\n                    break;\n                }\n            }\n        }\n        control.style.display = visible ? \"inherit\" : \"none\";\n    }\n\n    private findGroup(groupMap: Map<I18nKeys, HTMLDivElement>, prop: Property) {\n        let group = groupMap.get(prop.group!);\n        if (group === undefined) {\n            group = div({ className: style.group });\n            groupMap.set(prop.group!, group);\n            this.append(group);\n        }\n        return group;\n    }\n\n    private createItem(command: ICommand, g: Property) {\n        const noType = command as any;\n        const type = typeof noType[g.name];\n\n        if (g.type === \"materialId\") {\n            return this.materialEditor(g, noType);\n        }\n\n        switch (type) {\n            case \"function\":\n                return this.newButton(g, noType);\n            case \"boolean\":\n                return this.newCheckbox(g, noType);\n            case \"number\":\n                return this.newInput(g, noType, parseFloat);\n            case \"string\":\n                return this.newInput(g, noType);\n            default:\n                if (noType[g.name] instanceof Combobox) {\n                    return this.newCombobox(noType, g);\n                }\n                throw new Error(\"暂不支持的类型\");\n        }\n    }\n\n    private newCombobox(noType: any, g: Property) {\n        let combobox = noType[g.name] as Combobox<any>;\n        let options = combobox.items.map((item, index) => {\n            return option({\n                selected: index === combobox.selectedIndex,\n                textContent: I18n.isI18nKey(item)\n                    ? new Localize(item)\n                    : (combobox.converter?.convert(item).unchecked() ?? String(item)),\n            });\n        });\n\n        return div(\n            label({ textContent: new Localize(g.display) }),\n            select(\n                {\n                    className: style.select,\n                    onchange: (e) => {\n                        combobox.selectedIndex = (e.target as HTMLSelectElement).selectedIndex;\n                    },\n                },\n                ...options,\n            ),\n        );\n    }\n\n    private newInput(g: Property, noType: any, converter?: (v: string) => any) {\n        return div(\n            label({ textContent: new Localize(g.display) }),\n            input({\n                type: \"text\",\n                className: style.input,\n                value: new Binding(noType, g.name),\n                onblur: (e) => {\n                    const input = e.target as HTMLInputElement;\n                    noType[g.name] = converter ? converter(input.value) : input.value;\n                },\n                onkeydown: (e) => {\n                    e.stopPropagation();\n                    if (e.key === \"Enter\") {\n                        const input = e.target as HTMLInputElement;\n                        input.blur();\n                    }\n                },\n            }),\n        );\n    }\n\n    private newCheckbox(g: Property, noType: any) {\n        return div(\n            label({ textContent: new Localize(g.display) }),\n            input({\n                type: \"checkbox\",\n                checked: new Binding(noType, g.name),\n                onclick: () => {\n                    noType[g.name] = !noType[g.name];\n                },\n            }),\n        );\n    }\n\n    private newButton(g: Property, noType: any) {\n        return button({\n            className: style.button,\n            textContent: new Localize(g.display),\n            onclick: () => noType[g.name](),\n        });\n    }\n\n    private materialEditor(g: Property, noType: any) {\n        if (!(this.command instanceof CancelableCommand)) {\n            throw new Error(\"MaterialEditor only support CancelableCommand\");\n        }\n\n        const material = this.command.document.materials.find((x) => x.id === noType[g.name])!;\n        const display = material.clone();\n\n        return button({\n            className: style.materialButton,\n            style: {\n                backgroundColor: new Binding(display, \"color\", new ColorConverter()),\n                backgroundImage: new PathBinding(display, \"map.image\", new UrlStringConverter()),\n                backgroundBlendMode: \"multiply\",\n                backgroundSize: \"cover\",\n                cursor: \"pointer\",\n            },\n            textContent: new Localize(g.display),\n            onclick: () => {\n                if (this.command instanceof MultistepCommand) {\n                    PubSub.default.pub(\"editMaterial\", this.command.document, material, (newMaterial) => {\n                        noType[g.name] = newMaterial.id;\n                        display.color = newMaterial.color;\n                        display.map = newMaterial.map;\n                    });\n                }\n            },\n        });\n    }\n}\n\ncustomElements.define(\"command-context\", CommandContext);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { label, svg } from \"chili-controls\";\nimport {\n    ButtonSize,\n    Command,\n    CommandData,\n    CommandKeys,\n    I18n,\n    I18nKeys,\n    IConverter,\n    Localize,\n    Logger,\n    PubSub,\n    Result,\n} from \"chili-core\";\nimport style from \"./ribbonButton.module.css\";\n\nexport class RibbonButton extends HTMLElement {\n    constructor(\n        display: I18nKeys,\n        icon: string,\n        size: ButtonSize,\n        readonly onClick: () => void,\n    ) {\n        super();\n        this.initHTML(display, icon, size);\n        this.addEventListener(\"click\", onClick);\n    }\n\n    static fromCommandName(commandName: CommandKeys, size: ButtonSize) {\n        const data = Command.getData(commandName);\n        if (!data) {\n            Logger.warn(`commandData of ${commandName} is undefined`);\n            return undefined;\n        }\n        if (data.toggle) {\n            return new RibbonToggleButton(data, size);\n        }\n        return new RibbonButton(`command.${data.key}`, data.icon, size, () => {\n            PubSub.default.pub(\"executeCommand\", commandName);\n        });\n    }\n\n    dispose(): void {\n        this.removeEventListener(\"click\", this.onClick);\n    }\n\n    private initHTML(display: I18nKeys, icon: string, size: ButtonSize) {\n        const image = svg({ icon });\n        this.className = size === ButtonSize.large ? style.normal : style.small;\n        image.classList.add(size === ButtonSize.large ? style.icon : style.smallIcon);\n        const text = label({\n            className: size === ButtonSize.large ? style.largeButtonText : style.smallButtonText,\n            textContent: new Localize(display),\n        });\n        I18n.set(this, \"title\", display);\n        this.append(image, text);\n    }\n}\n\ncustomElements.define(\"ribbon-button\", RibbonButton);\n\nclass ToggleConverter implements IConverter {\n    constructor(\n        readonly className: string,\n        readonly active: string,\n    ) {}\n    convert(isChecked: boolean): Result<string, string> {\n        return isChecked ? Result.ok(`${this.className} ${this.active}`) : Result.ok(this.className);\n    }\n}\n\nexport class RibbonToggleButton extends RibbonButton {\n    constructor(data: CommandData, size: ButtonSize) {\n        super(`command.${data.key}`, data.icon, size, () => {\n            PubSub.default.pub(\"executeCommand\", data.key);\n        });\n\n        if (data.toggle) {\n            data.toggle.converter = new ToggleConverter(this.className, style.checked);\n            data.toggle.setBinding(this, \"className\");\n        }\n    }\n}\n\ncustomElements.define(\"ribbon-toggle-button\", RibbonToggleButton);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport style from \"./ribbonStack.module.css\";\n\nexport class RibbonStack extends HTMLElement {\n    constructor() {\n        super();\n        this.className = style.root;\n    }\n}\n\ncustomElements.define(\"ribbon-stack\", RibbonStack);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { a, collection, div, label, span, svg } from \"chili-controls\";\nimport {\n    Binding,\n    ButtonSize,\n    Command,\n    CommandKeys,\n    I18n,\n    IApplication,\n    ICommand,\n    IConverter,\n    IView,\n    Localize,\n    Logger,\n    Observable,\n    ObservableCollection,\n    PubSub,\n    Result,\n} from \"chili-core\";\nimport { CommandContext } from \"./commandContext\";\nimport style from \"./ribbon.module.css\";\nimport { RibbonButton } from \"./ribbonButton\";\nimport { RibbonCommandData, RibbonGroupData, RibbonTabData } from \"./ribbonData\";\nimport { RibbonStack } from \"./ribbonStack\";\n\nexport class RibbonDataContent extends Observable {\n    readonly quickCommands = new ObservableCollection<CommandKeys>();\n    readonly ribbonTabs = new ObservableCollection<RibbonTabData>();\n    private _activeTab: RibbonTabData;\n    private _activeView: IView | undefined;\n\n    constructor(\n        readonly app: IApplication,\n        quickCommands: CommandKeys[],\n        ribbonTabs: RibbonTabData[],\n    ) {\n        super();\n        this.quickCommands.push(...quickCommands);\n        this.ribbonTabs.push(...ribbonTabs);\n        this._activeTab = ribbonTabs[0];\n        PubSub.default.sub(\"activeViewChanged\", (v) => (this.activeView = v));\n    }\n\n    get activeTab() {\n        return this._activeTab;\n    }\n    set activeTab(value: RibbonTabData) {\n        this.setProperty(\"activeTab\", value);\n    }\n\n    get activeView() {\n        return this._activeView;\n    }\n    set activeView(value: IView | undefined) {\n        this.setProperty(\"activeView\", value);\n    }\n}\n\nexport const QuickButton = (command: ICommand) => {\n    const data = Command.getData(command);\n    if (!data) {\n        Logger.warn(\"commandData is undefined\");\n        return span({ textContent: \"null\" });\n    }\n\n    return svg({\n        icon: data.icon,\n        title: new Localize(`command.${data.key}`),\n        onclick: () => PubSub.default.pub(\"executeCommand\", data.key),\n    });\n};\n\nclass ViewActiveConverter implements IConverter<IView> {\n    constructor(\n        readonly target: IView,\n        readonly style: string,\n        readonly activeStyle: string,\n    ) {}\n\n    convert(value: IView): Result<string> {\n        return Result.ok(this.target === value ? `${this.style} ${this.activeStyle}` : this.style);\n    }\n}\n\nclass ActivedRibbonTabConverter implements IConverter<RibbonTabData> {\n    constructor(\n        readonly tab: RibbonTabData,\n        readonly style: string,\n        readonly activeStyle: string,\n    ) {}\n\n    convert(value: RibbonTabData): Result<string> {\n        return Result.ok(this.tab === value ? `${this.style} ${this.activeStyle}` : this.style);\n    }\n}\n\nclass DisplayConverter implements IConverter<RibbonTabData> {\n    constructor(readonly tab: RibbonTabData) {}\n\n    convert(value: RibbonTabData): Result<string> {\n        return Result.ok(this.tab === value ? \"\" : \"none\");\n    }\n}\n\nexport class Ribbon extends HTMLElement {\n    private readonly _commandContext = div({ className: style.commandContextPanel });\n    private commandContext?: CommandContext;\n\n    constructor(readonly dataContent: RibbonDataContent) {\n        super();\n        this.className = style.root;\n        this.append(this.header(), this.ribbonTabs(), this._commandContext);\n    }\n\n    private header() {\n        return div({ className: style.titleBar }, this.leftPanel(), this.centerPanel(), this.rightPanel());\n    }\n\n    private leftPanel() {\n        return div(\n            { className: style.left },\n            div(\n                { className: style.appIcon, onclick: () => PubSub.default.pub(\"displayHome\", true) },\n                svg({ className: style.icon, icon: \"icon-chili\" }),\n                span({ id: \"appName\", textContent: `Chili3D - v${__APP_VERSION__}` }),\n            ),\n            div(\n                { className: style.ribbonTitlePanel },\n                svg({\n                    className: style.home,\n                    icon: \"icon-home\",\n                    onclick: () => PubSub.default.pub(\"displayHome\", true),\n                }),\n                collection({\n                    className: style.quickCommands,\n                    sources: this.dataContent.quickCommands,\n                    template: (command: CommandKeys) => QuickButton(command as any),\n                }),\n                span({ className: style.split }),\n                this.createRibbonHeader(),\n            ),\n        );\n    }\n\n    private createRibbonHeader() {\n        return collection({\n            sources: this.dataContent.ribbonTabs,\n            template: (tab: RibbonTabData) => {\n                const converter = new ActivedRibbonTabConverter(tab, style.tabHeader, style.activedTab);\n                return label({\n                    className: new Binding(this.dataContent, \"activeTab\", converter),\n                    textContent: new Localize(tab.tabName),\n                    onclick: () => (this.dataContent.activeTab = tab),\n                });\n            },\n        });\n    }\n\n    private centerPanel() {\n        return div(\n            { className: style.center },\n            collection({\n                className: style.views,\n                sources: this.dataContent.app.views,\n                template: (view) => this.createViewItem(view),\n            }),\n            svg({\n                className: style.new,\n                icon: \"icon-plus\",\n                title: I18n.translate(\"command.doc.new\"),\n                onclick: () => PubSub.default.pub(\"executeCommand\", \"doc.new\"),\n            }),\n        );\n    }\n\n    private createViewItem(view: IView) {\n        return div(\n            {\n                className: new Binding(\n                    this.dataContent,\n                    \"activeView\",\n                    new ViewActiveConverter(view, style.tab, style.active),\n                ),\n                onclick: () => {\n                    this.dataContent.app.activeView = view;\n                },\n            },\n            div({ className: style.name }, span({ textContent: new Binding(view.document, \"name\") })),\n            svg({\n                className: style.close,\n                icon: \"icon-times\",\n                onclick: (e) => {\n                    e.stopPropagation();\n                    view.close();\n                },\n            }),\n        );\n    }\n\n    private rightPanel() {\n        return div(\n            { className: style.right },\n            a(\n                { href: \"https://github.com/xiangechen/chili3d\", target: \"_blank\" },\n                svg({ title: \"Github\", className: style.icon, icon: \"icon-github\" }),\n            ),\n        );\n    }\n\n    private ribbonTabs() {\n        return collection({\n            className: style.tabContentPanel,\n            sources: this.dataContent.ribbonTabs,\n            template: (tab: RibbonTabData) => this.ribbonTab(tab),\n        });\n    }\n\n    private ribbonTab(tab: RibbonTabData) {\n        return collection({\n            className: style.groupPanel,\n            sources: tab.groups,\n            style: {\n                display: new Binding(this.dataContent, \"activeTab\", new DisplayConverter(tab)),\n            },\n            template: (group: RibbonGroupData) => this.ribbonGroup(group),\n        });\n    }\n\n    private ribbonGroup(group: RibbonGroupData) {\n        return div(\n            { className: style.ribbonGroup },\n            collection({\n                sources: group.items,\n                className: style.content,\n                template: (item) => this.ribbonButton(item),\n            }),\n            label({ className: style.header, textContent: new Localize(group.groupName) }),\n        );\n    }\n\n    private ribbonButton(item: RibbonCommandData) {\n        if (typeof item === \"string\") {\n            return RibbonButton.fromCommandName(item, ButtonSize.large)!;\n        } else if (item instanceof ObservableCollection) {\n            const stack = new RibbonStack();\n            item.forEach((b) => {\n                const button = RibbonButton.fromCommandName(b, ButtonSize.small);\n                if (button) stack.append(button);\n            });\n            return stack;\n        } else {\n            return new RibbonButton(item.display, item.icon, ButtonSize.large, item.onClick);\n        }\n    }\n\n    connectedCallback(): void {\n        PubSub.default.sub(\"openCommandContext\", this.openContext);\n        PubSub.default.sub(\"closeCommandContext\", this.closeContext);\n    }\n\n    disconnectedCallback(): void {\n        PubSub.default.remove(\"openCommandContext\", this.openContext);\n        PubSub.default.remove(\"closeCommandContext\", this.closeContext);\n    }\n\n    private readonly openContext = (command: ICommand) => {\n        if (this.commandContext) {\n            this.closeContext();\n        }\n        this.commandContext = new CommandContext(command);\n        this._commandContext.append(this.commandContext);\n    };\n\n    private readonly closeContext = () => {\n        this.commandContext?.remove();\n        this.commandContext?.dispose();\n        this.commandContext = undefined;\n        this._commandContext.innerHTML = \"\";\n    };\n}\n\ncustomElements.define(\"chili-ribbon\", Ribbon);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport {\n    Button,\n    CommandKeys,\n    I18nKeys,\n    Observable,\n    ObservableCollection,\n    RibbonGroup,\n    RibbonTab,\n} from \"chili-core\";\n\nexport type RibbonCommandData = CommandKeys | ObservableCollection<CommandKeys> | Button;\n\nexport class RibbonGroupData extends Observable {\n    readonly items: ObservableCollection<RibbonCommandData>;\n\n    get groupName(): I18nKeys {\n        return this.getPrivateValue(\"groupName\");\n    }\n    set groupName(value: I18nKeys) {\n        this.setProperty(\"groupName\", value);\n    }\n\n    constructor(groupName: I18nKeys, ...items: RibbonCommandData[]) {\n        super();\n        this.setPrivateValue(\"groupName\", groupName);\n        this.items = new ObservableCollection<RibbonCommandData>(...items);\n    }\n\n    static fromProfile(profile: RibbonGroup) {\n        return new RibbonGroupData(\n            profile.groupName,\n            ...profile.items.map((item) => {\n                return Array.isArray(item) ? new ObservableCollection(...item) : item;\n            }),\n        );\n    }\n}\n\nexport class RibbonTabData extends Observable {\n    readonly groups = new ObservableCollection<RibbonGroupData>();\n\n    get tabName(): I18nKeys {\n        return this.getPrivateValue(\"tabName\");\n    }\n    set tabName(value: I18nKeys) {\n        this.setProperty(\"tabName\", value);\n    }\n\n    constructor(tabName: I18nKeys, ...groups: RibbonGroupData[]) {\n        super();\n        this.setPrivateValue(\"tabName\", tabName);\n        this.groups.push(...groups);\n    }\n\n    static fromProfile(profile: RibbonTab) {\n        return new RibbonTabData(\n            profile.tabName,\n            ...profile.groups.map((group) => RibbonGroupData.fromProfile(group)),\n        );\n    }\n}\n\nexport type RibbonData = RibbonTabData[];\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, input, label } from \"chili-controls\";\nimport { Config, I18nKeys, Localize, ObjectSnapType } from \"chili-core\";\nimport style from \"./snapConfig.module.css\";\n\nconst SnapTypes: Array<{\n    type: ObjectSnapType;\n    display: I18nKeys;\n}> = [\n    {\n        type: ObjectSnapType.endPoint,\n        display: \"snap.end\",\n    },\n    {\n        type: ObjectSnapType.midPoint,\n        display: \"snap.mid\",\n    },\n    {\n        type: ObjectSnapType.center,\n        display: \"snap.center\",\n    },\n    {\n        type: ObjectSnapType.perpendicular,\n        display: \"snap.perpendicular\",\n    },\n    {\n        type: ObjectSnapType.intersection,\n        display: \"snap.intersection\",\n    },\n];\n\nexport class SnapConfig extends HTMLElement {\n    constructor() {\n        super();\n        this.className = style.container;\n        Config.instance.onPropertyChanged(this.snapTypeChanged);\n\n        this.render();\n    }\n\n    private readonly snapTypeChanged = (property: keyof Config) => {\n        if (property === \"snapType\" || property === \"enableSnap\" || property === \"enableSnapTracking\") {\n            this.innerHTML = \"\";\n            this.render();\n        }\n    };\n\n    private handleSnapClick(snapType: ObjectSnapType) {\n        if (ObjectSnapType.has(Config.instance.snapType, snapType)) {\n            Config.instance.snapType = ObjectSnapType.remove(Config.instance.snapType, snapType);\n        } else {\n            Config.instance.snapType = ObjectSnapType.add(Config.instance.snapType, snapType);\n        }\n    }\n\n    private render() {\n        this.append(\n            ...SnapTypes.map((snapType) => {\n                return div(\n                    input({\n                        type: \"checkbox\",\n                        id: `snap-${snapType.type}`,\n                        checked: ObjectSnapType.has(Config.instance.snapType, snapType.type),\n                        onclick: () => this.handleSnapClick(snapType.type),\n                    }),\n                    label({\n                        htmlFor: `snap-${snapType.type}`,\n                        textContent: new Localize(snapType.display),\n                    }),\n                );\n            }),\n            div(\n                input({\n                    type: \"checkbox\",\n                    id: \"snap-tracking\",\n                    checked: Config.instance.enableSnapTracking,\n                    onclick: () =>\n                        (Config.instance.enableSnapTracking = !Config.instance.enableSnapTracking),\n                }),\n                label({\n                    htmlFor: \"snap-tracking\",\n                    textContent: new Localize(\"statusBar.tracking\"),\n                }),\n            ),\n        );\n    }\n}\n\ncustomElements.define(\"chili-snap-config\", SnapConfig);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, label } from \"chili-controls\";\nimport { Config, I18n, I18nKeys, Navigation3D, PubSub } from \"chili-core\";\nimport { SnapConfig } from \"./snapConfig\";\nimport style from \"./statusbar.module.css\";\n\nexport class Statusbar extends HTMLElement {\n    private _isDefaultTip = true;\n\n    readonly tip = label({\n        textContent: \"\",\n        className: style.tip,\n    });\n\n    constructor(className: string) {\n        super();\n        this.className = `${style.panel} ${className}`;\n\n        this.setDefaultTip();\n        this.render();\n\n        PubSub.default.sub(\"statusBarTip\", this.statusBarTip);\n        PubSub.default.sub(\"clearStatusBarTip\", this.setDefaultTip);\n        Config.instance.onPropertyChanged(this.handleConfigChanged);\n    }\n\n    private readonly handleConfigChanged = (prop: keyof Config) => {\n        if (prop === \"navigation3DIndex\" && this._isDefaultTip) {\n            this.setDefaultTip();\n        }\n    };\n\n    private render() {\n        this.append(\n            div({ className: style.left }, this.tip),\n            div({ className: style.right }, new SnapConfig()),\n        );\n    }\n\n    private readonly statusBarTip = (tip: I18nKeys) => {\n        this._isDefaultTip = false;\n        I18n.set(this.tip, \"textContent\", tip);\n    };\n\n    private readonly setDefaultTip = () => {\n        this._isDefaultTip = true;\n        const { pan, rotate } = Navigation3D.navigationKeyMap();\n        I18n.set(this.tip, \"textContent\", \"prompt.default{0}{1}\", pan, rotate);\n    };\n}\n\ncustomElements.define(\"chili-statusbar\", Statusbar);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { CursorType } from \"chili-core\";\nimport draw from \"./draw.cur\";\n\nconst cursors: Map<CursorType, string> = new Map([\n    [\"default\", \"default\"],\n    [\"draw\", `url(${draw}), default`],\n    [\"select.default\", \"crosshair\"],\n]);\n\nexport namespace Cursor {\n    export function get(type: CursorType) {\n        return cursors.get(type) ?? \"default\";\n    }\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { input, label } from \"chili-controls\";\nimport { I18n, I18nKeys, IDisposable, Localize, Result } from \"chili-core\";\nimport style from \"./input.module.css\";\n\nexport class Input extends HTMLElement implements IDisposable {\n    private readonly _cancelledCallbacks: (() => void)[] = [];\n    private readonly _completedCallbacks: (() => void)[] = [];\n    private readonly textbox: HTMLInputElement;\n    private tip?: HTMLLabelElement;\n\n    constructor(\n        text: string,\n        readonly handler: (text: string) => Result<string, I18nKeys>,\n    ) {\n        super();\n        this.className = style.panel;\n        this.textbox = input({\n            value: text,\n            onkeydown: this.handleKeyDown,\n        });\n        this.append(this.textbox);\n    }\n\n    onCancelled(callback: () => void) {\n        this._cancelledCallbacks.push(callback);\n    }\n\n    onCompleted(callback: () => void) {\n        this._completedCallbacks.push(callback);\n    }\n\n    get text(): string {\n        return this.textbox.value;\n    }\n\n    override focus() {\n        this.textbox.focus();\n    }\n\n    dispose() {\n        this._cancelledCallbacks.length = 0;\n        this._completedCallbacks.length = 0;\n    }\n\n    private showTip(tip: I18nKeys) {\n        if (this.tip === undefined) {\n            this.tip = label({\n                textContent: new Localize(tip),\n                className: style.error,\n            });\n            this.append(this.tip);\n        } else {\n            I18n.set(this.tip, \"textContent\", tip);\n        }\n    }\n\n    private removeTip() {\n        if (this.tip === undefined) return;\n        this.removeChild(this.tip);\n        this.tip = undefined;\n    }\n\n    private readonly handleKeyDown = (e: KeyboardEvent) => {\n        e.stopPropagation();\n        if (e.key === \"Enter\") {\n            this.processEnterKey();\n        } else if (e.key === \"Escape\") {\n            this._cancelledCallbacks.forEach((callback) => callback());\n        } else {\n            this.removeTip();\n        }\n    };\n\n    private processEnterKey() {\n        this.textbox.readOnly = true;\n        const error = this.handler(this.textbox.value);\n        if (error.isOk) {\n            this._completedCallbacks.forEach((callback) => callback());\n        } else {\n            this.textbox.readOnly = false;\n            this.showTip(error.error);\n        }\n    }\n}\n\ncustomElements.define(\"chili-input\", Input);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { MessageType } from \"chili-core\";\nimport style from \"./tip.module.css\";\n\nexport class Tip extends HTMLElement {\n    private color?: string;\n\n    constructor(msg: string, type: MessageType) {\n        super();\n        this.className = style.tip;\n        this.set(msg, type);\n    }\n\n    set(msg: string, type: MessageType) {\n        if (this.textContent !== msg) {\n            this.textContent = msg;\n        }\n\n        let newStyle = this.getStyle(type);\n        this.setStyle(newStyle);\n    }\n\n    private setStyle(newStyle: string) {\n        if (this.color !== newStyle && newStyle !== undefined) {\n            if (this.color !== undefined) this.classList.remove(this.color);\n            this.classList.add(newStyle);\n            this.color = newStyle;\n        }\n    }\n\n    private getStyle(type: MessageType) {\n        switch (type) {\n            case MessageType.error:\n                return style.error;\n            case MessageType.warn:\n                return style.warn;\n            default:\n                return style.info;\n        }\n    }\n}\n\ncustomElements.define(\"chili-tip\", Tip);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { I18nKeys, MessageType, PubSub, Result } from \"chili-core\";\nimport style from \"./flyout.module.css\";\nimport { Input } from \"./input\";\nimport { Tip } from \"./tip\";\n\nexport class Flyout extends HTMLElement {\n    private _tip: Tip | undefined;\n    private _input: Input | undefined;\n    private lastFocus: HTMLElement | null = null;\n\n    constructor() {\n        super();\n        this.className = style.root;\n    }\n\n    connectedCallback(): void {\n        PubSub.default.sub(\"showFloatTip\", this.showTip);\n        PubSub.default.sub(\"clearFloatTip\", this.clearTip);\n        PubSub.default.sub(\"showInput\", this.displayInput);\n        PubSub.default.sub(\"clearInput\", this.clearInput);\n    }\n\n    disconnectedCallback(): void {\n        PubSub.default.remove(\"showFloatTip\", this.showTip);\n        PubSub.default.remove(\"clearFloatTip\", this.clearTip);\n        PubSub.default.remove(\"showInput\", this.displayInput);\n        PubSub.default.remove(\"clearInput\", this.clearInput);\n    }\n\n    private readonly showTip = (level: MessageType, msg: string) => {\n        if (this._tip === undefined) {\n            this._tip = new Tip(msg, level);\n            this.append(this._tip);\n        } else {\n            this._tip.set(msg, level);\n        }\n    };\n\n    private readonly clearTip = () => {\n        if (this._tip !== undefined) {\n            this._tip.remove();\n            this._tip = undefined;\n        }\n    };\n\n    private readonly displayInput = (text: string, handler: (text: string) => Result<string, I18nKeys>) => {\n        if (this._input === undefined) {\n            this.lastFocus = document.activeElement as HTMLElement;\n            this._input = new Input(text, handler);\n            this._input.onCancelled(this.clearInput);\n            this._input.onCompleted(this.clearInput);\n            this.append(this._input);\n            this._input.focus();\n        }\n    };\n\n    private readonly clearInput = () => {\n        if (this._input !== undefined) {\n            this.removeChild(this._input);\n            this._input.dispose();\n            this._input = undefined;\n            this.lastFocus?.focus();\n        }\n    };\n}\n\ncustomElements.define(\"chili-flyout\", Flyout);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { collection, div, input, label, span, svg } from \"chili-controls\";\nimport {\n    Act,\n    Binding,\n    CameraType,\n    DialogResult,\n    IConverter,\n    IView,\n    Localize,\n    PubSub,\n    Result,\n} from \"chili-core\";\nimport { Flyout } from \"./flyout\";\nimport style from \"./viewport.module.css\";\n\nclass CameraConverter implements IConverter<CameraType> {\n    constructor(readonly type: CameraType) {}\n\n    convert(value: CameraType): Result<string, string> {\n        if (value === this.type) {\n            return Result.ok(style.actived);\n        }\n        return Result.ok(\"\");\n    }\n}\n\nexport class Viewport extends HTMLElement {\n    private readonly _flyout: Flyout;\n    private readonly _eventCaches: [keyof HTMLElementEventMap, (e: any) => void][] = [];\n    private readonly _acts: HTMLElement;\n\n    constructor(\n        readonly view: IView,\n        readonly showViewControls: boolean,\n    ) {\n        super();\n        this.className = style.root;\n        this._flyout = new Flyout();\n        this._acts = this.createActs();\n        this.render();\n        view.setDom(this);\n    }\n\n    private readonly onActCollectionChanged = () => {\n        if (this.view.document.acts.length === 0) {\n            this._acts.style.display = \"none\";\n        } else {\n            this._acts.style.display = \"flex\";\n        }\n    };\n\n    private render() {\n        this.append(\n            this._acts,\n            this.showViewControls\n                ? div(\n                      {\n                          className: style.viewControls,\n                          onpointerdown: (ev) => ev.stopPropagation(),\n                          onclick: (e) => e.stopPropagation(),\n                      },\n                      this.createCameraControls(),\n                      this.createActionControls(),\n                  )\n                : \"\",\n        );\n    }\n\n    private createCameraControls() {\n        return div(\n            { className: style.border },\n            this.createCameraControl(\"orthographic\", \"icon-orthographic\"),\n            this.createCameraControl(\"perspective\", \"icon-perspective\"),\n        );\n    }\n\n    private createActionControls() {\n        return div(\n            { className: style.border },\n            svg({\n                icon: \"icon-fitcontent\",\n                title: new Localize(\"viewport.fitContent\"),\n                onclick: async (e) => {\n                    e.stopPropagation();\n                    this.view.cameraController.fitContent();\n                    this.view.update();\n                },\n            }),\n            svg({\n                icon: \"icon-zoomin\",\n                title: new Localize(\"viewport.zoomIn\"),\n                onclick: () => {\n                    this.view.cameraController.zoom(this.view.width / 2, this.view.height / 2, -5);\n                    this.view.update();\n                },\n            }),\n            svg({\n                icon: \"icon-zoomout\",\n                title: new Localize(\"viewport.zoomOut\"),\n                onclick: () => {\n                    this.view.cameraController.zoom(this.view.width / 2, this.view.height / 2, 5);\n                    this.view.update();\n                },\n            }),\n        );\n    }\n\n    private createActs() {\n        return div(\n            { className: style.actsContainer },\n            div(\n                {\n                    className: style.border,\n                    onpointerdown: (ev) => ev.stopPropagation(),\n                    onclick: (e) => e.stopPropagation(),\n                },\n                collection({\n                    className: style.acts,\n                    sources: this.view.document.acts,\n                    template: (v) => {\n                        return div(\n                            {\n                                onclick: () => {\n                                    this.view.cameraController.lookAt(\n                                        v.cameraPosition,\n                                        v.cameraTarget,\n                                        v.cameraUp,\n                                    );\n                                    this.view.update();\n                                },\n                            },\n                            span({\n                                textContent: new Binding(v, \"name\"),\n                            }),\n                            div(\n                                {\n                                    className: style.tools,\n                                },\n                                svg({\n                                    icon: \"icon-cog\",\n                                    onclick: () => this.setActName(v),\n                                }),\n                                svg({\n                                    icon: \"icon-times\",\n                                    onclick: () => {\n                                        this.view.document.acts.remove(v);\n                                    },\n                                }),\n                            ),\n                        );\n                    },\n                    onwheel: (e) => {\n                        e.preventDefault();\n                        const container = e.currentTarget as HTMLElement;\n                        container.scrollLeft += e.deltaY;\n                    },\n                }),\n            ),\n        );\n    }\n\n    private readonly setActName = (act: Act) => {\n        const inputBox = input({\n            value: act.name,\n            onkeydown: (e) => {\n                e.stopPropagation();\n            },\n        });\n        PubSub.default.pub(\n            \"showDialog\",\n            \"ribbon.group.act\",\n            div(label({ textContent: new Localize(\"common.name\") }), \": \", inputBox),\n            (result) => {\n                if (result === DialogResult.ok) {\n                    act.name = inputBox.value;\n                }\n            },\n        );\n    };\n\n    private createCameraControl(cameraType: CameraType, icon: string) {\n        return div(\n            {\n                className: new Binding(\n                    this.view.cameraController,\n                    \"cameraType\",\n                    new CameraConverter(cameraType),\n                ),\n            },\n            svg({\n                icon: icon,\n                title: new Localize(`viewport.${cameraType}`),\n                onclick: (e) => {\n                    e.stopPropagation();\n                    this.view.cameraController.cameraType = cameraType;\n                    this.view.update();\n                },\n            }),\n        );\n    }\n\n    connectedCallback() {\n        this.initEvent();\n        this.appendChild(this._flyout);\n        this.view.document.acts.onCollectionChanged(this.onActCollectionChanged);\n        this.onActCollectionChanged();\n    }\n\n    disconnectedCallback() {\n        this.removeEvents();\n        this._flyout.remove();\n        this.view.document.acts.removeCollectionChanged(this.onActCollectionChanged);\n    }\n\n    dispose() {\n        this.removeEvents();\n    }\n\n    private initEvent() {\n        let events: [keyof HTMLElementEventMap, (view: IView, e: any) => any][] = [\n            [\"pointerdown\", this.pointerDown],\n            [\"pointermove\", this.pointerMove],\n            [\"pointerout\", this.pointerOut],\n            [\"pointerup\", this.pointerUp],\n            [\"wheel\", this.mouseWheel],\n        ];\n        events.forEach((v) => {\n            this.addEventListenerHandler(v[0], v[1]);\n        });\n    }\n\n    private addEventListenerHandler(type: keyof HTMLElementEventMap, handler: (view: IView, e: any) => any) {\n        let listener = (e: any) => {\n            e.preventDefault();\n            handler(this.view, e);\n        };\n        this.addEventListener(type, listener);\n        this._eventCaches.push([type, listener]);\n    }\n\n    private removeEvents() {\n        this._eventCaches.forEach((x) => {\n            this.removeEventListener(x[0], x[1]);\n        });\n        this._eventCaches.length = 0;\n    }\n\n    private readonly pointerMove = (view: IView, event: PointerEvent) => {\n        if (this._flyout) {\n            this._flyout.style.top = event.offsetY + \"px\";\n            this._flyout.style.left = event.offsetX + \"px\";\n        }\n        view.document.visual.eventHandler.pointerMove(view, event);\n        view.document.visual.viewHandler.pointerMove(view, event);\n    };\n\n    private readonly pointerDown = (view: IView, event: PointerEvent) => {\n        if (document.activeElement instanceof HTMLElement) {\n            document.activeElement.blur();\n        }\n\n        view.document.application.activeView = view;\n        view.document.visual.eventHandler.pointerDown(view, event);\n        view.document.visual.viewHandler.pointerDown(view, event);\n    };\n\n    private readonly pointerUp = (view: IView, event: PointerEvent) => {\n        view.document.visual.eventHandler.pointerUp(view, event);\n        view.document.visual.viewHandler.pointerUp(view, event);\n    };\n\n    private readonly pointerOut = (view: IView, event: PointerEvent) => {\n        view.document.visual.eventHandler.pointerOut?.(view, event);\n        view.document.visual.viewHandler.pointerOut?.(view, event);\n    };\n\n    private readonly mouseWheel = (view: IView, event: WheelEvent) => {\n        view.document.visual.eventHandler.mouseWheel?.(view, event);\n        view.document.visual.viewHandler.mouseWheel?.(view, event);\n    };\n}\n\ncustomElements.define(\"chili-uiview\", Viewport);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport {\n    CollectionAction,\n    CollectionChangedArgs,\n    CursorType,\n    IApplication,\n    IView,\n    PubSub\n} from \"chili-core\";\nimport { Cursor } from \"../cursor\";\nimport style from \"./layoutViewport.module.css\";\nimport { Viewport } from \"./viewport\";\n\nexport class LayoutViewport extends HTMLElement {\n    private readonly _viewports: Map<IView, Viewport> = new Map();\n\n    constructor(readonly app: IApplication, readonly showViewControls: boolean = true) {\n        super();\n        this.className = style.root;\n        app.views.onCollectionChanged(this._handleViewCollectionChanged);\n    }\n\n    private readonly _handleViewCollectionChanged = (args: CollectionChangedArgs) => {\n        if (args.action === CollectionAction.add) {\n            args.items.forEach((view) => {\n                this.createViewport(view);\n            });\n        } else if (args.action === CollectionAction.remove) {\n            args.items.forEach((view) => {\n                let viewport = this._viewports.get(view);\n                viewport?.remove();\n                viewport?.dispose();\n                this._viewports.delete(view);\n            });\n        }\n    };\n\n    connectedCallback(): void {\n        PubSub.default.sub(\"activeViewChanged\", this._handleActiveViewChanged);\n        PubSub.default.sub(\"viewCursor\", this._handleCursor);\n    }\n\n    disconnectedCallback(): void {\n        PubSub.default.remove(\"activeViewChanged\", this._handleActiveViewChanged);\n        PubSub.default.remove(\"viewCursor\", this._handleCursor);\n    }\n\n    private readonly _handleCursor = (type: CursorType) => {\n        this.style.cursor = Cursor.get(type);\n    };\n\n    private createViewport(view: IView) {\n        let viewport = new Viewport(view, this.showViewControls);\n        viewport.classList.add(style.viewport, style.hidden);\n        this.appendChild(viewport);\n        this._viewports.set(view, viewport);\n        return viewport;\n    }\n\n    private readonly _handleActiveViewChanged = (view: IView | undefined) => {\n        this._viewports.forEach((v) => {\n            if (v.view === view) {\n                v.classList.remove(style.hidden);\n            } else {\n                v.classList.add(style.hidden);\n            }\n        });\n    };\n}\n\ncustomElements.define(\"chili-viewport\", LayoutViewport);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div } from \"chili-controls\";\nimport {\n    AsyncController,\n    Button,\n    CommandKeys,\n    I18nKeys,\n    IApplication,\n    IDocument,\n    Material,\n    PubSub,\n    RibbonTab,\n} from \"chili-core\";\nimport style from \"./editor.module.css\";\nimport { OKCancel } from \"./okCancel\";\nimport { ProjectView } from \"./project\";\nimport { PropertyView } from \"./property\";\nimport { MaterialDataContent, MaterialEditor } from \"./property/material\";\nimport { Ribbon, RibbonDataContent } from \"./ribbon\";\nimport { RibbonTabData } from \"./ribbon/ribbonData\";\nimport { Statusbar } from \"./statusbar\";\nimport { LayoutViewport } from \"./viewport\";\n\nlet quickCommands: CommandKeys[] = [\"doc.save\", \"doc.saveToFile\", \"edit.undo\", \"edit.redo\"];\n\nexport class Editor extends HTMLElement {\n    readonly ribbonContent: RibbonDataContent;\n    private readonly _selectionController: OKCancel;\n    private readonly _viewportContainer: HTMLDivElement;\n    private _sidebarWidth: number = 360;\n    private _isResizingSidebar: boolean = false;\n    private _sidebarEl: HTMLDivElement | null = null;\n\n    constructor(app: IApplication, tabs: RibbonTab[]) {\n        super();\n        this.ribbonContent = new RibbonDataContent(app, quickCommands, tabs.map(RibbonTabData.fromProfile));\n        const viewport = new LayoutViewport(app);\n        viewport.classList.add(style.viewport);\n        this._selectionController = new OKCancel();\n        this._viewportContainer = div(\n            { className: style.viewportContainer },\n            this._selectionController,\n            viewport,\n        );\n        this.clearSelectionControl();\n        this.render();\n        document.body.appendChild(this);\n    }\n\n    private render() {\n        this._sidebarEl = div(\n            {\n                className: style.sidebar,\n                style: `width: ${this._sidebarWidth}px;`,\n            },\n            new ProjectView({ className: style.sidebarItem }),\n            new PropertyView({ className: style.sidebarItem }),\n            div({\n                className: style.sidebarResizer,\n                onmousedown: (e: MouseEvent) => this._startSidebarResize(e),\n            }),\n        );\n        this.append(\n            div(\n                { className: style.root },\n                new Ribbon(this.ribbonContent),\n                div({ className: style.content }, this._sidebarEl, this._viewportContainer),\n                new Statusbar(style.statusbar),\n            ),\n        );\n    }\n\n    private _startSidebarResize(e: MouseEvent) {\n        e.preventDefault();\n        this._isResizingSidebar = true;\n        document.body.style.cursor = \"ew-resize\";\n        const onMouseMove = (ev: MouseEvent) => {\n            if (!this._isResizingSidebar) return;\n            if (!this._sidebarEl) return;\n            const sidebarRect = this._sidebarEl.getBoundingClientRect();\n            let newWidth = ev.clientX - sidebarRect.left;\n            const minWidth = 75;\n            const maxWidth = Math.floor(window.innerWidth * 0.85);\n            newWidth = Math.max(minWidth, Math.min(maxWidth, newWidth));\n            this._sidebarWidth = newWidth;\n            this._sidebarEl.style.width = `${newWidth}px`;\n        };\n        const onMouseUp = () => {\n            this._isResizingSidebar = false;\n            document.body.style.cursor = \"\";\n            window.removeEventListener(\"mousemove\", onMouseMove);\n            window.removeEventListener(\"mouseup\", onMouseUp);\n        };\n        window.addEventListener(\"mousemove\", onMouseMove);\n        window.addEventListener(\"mouseup\", onMouseUp);\n    }\n\n    connectedCallback(): void {\n        PubSub.default.sub(\"showSelectionControl\", this.showSelectionControl);\n        PubSub.default.sub(\"editMaterial\", this._handleMaterialEdit);\n        PubSub.default.sub(\"clearSelectionControl\", this.clearSelectionControl);\n    }\n\n    disconnectedCallback(): void {\n        PubSub.default.remove(\"showSelectionControl\", this.showSelectionControl);\n        PubSub.default.remove(\"editMaterial\", this._handleMaterialEdit);\n        PubSub.default.remove(\"clearSelectionControl\", this.clearSelectionControl);\n    }\n\n    private readonly showSelectionControl = (controller: AsyncController) => {\n        this._selectionController.setControl(controller);\n        this._selectionController.style.visibility = \"visible\";\n        this._selectionController.style.zIndex = \"1000\";\n    };\n\n    private readonly clearSelectionControl = () => {\n        this._selectionController.setControl(undefined);\n        this._selectionController.style.visibility = \"hidden\";\n    };\n\n    private readonly _handleMaterialEdit = (\n        document: IDocument,\n        editingMaterial: Material,\n        callback: (material: Material) => void,\n    ) => {\n        let context = new MaterialDataContent(document, callback, editingMaterial);\n        this._viewportContainer.append(new MaterialEditor(context));\n    };\n\n    registerRibbonCommand(tabName: I18nKeys, groupName: I18nKeys, command: CommandKeys | Button) {\n        const tab = this.ribbonContent.ribbonTabs.find((p) => p.tabName === tabName);\n        const group = tab?.groups.find((p) => p.groupName === groupName);\n        group?.items.push(command);\n    }\n}\n\ncustomElements.define(\"chili-editor\", Editor);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { HTMLProps, option, select } from \"chili-controls\";\nimport { Config, I18n } from \"chili-core\";\n\nexport const LanguageSelector = (props: HTMLProps<HTMLElement>) => {\n    let languages: HTMLOptionElement[] = [];\n    I18n.languages.forEach((language, index) =>\n        languages.push(\n            option({\n                selected: index === I18n.currentLanguage(),\n                textContent: language.display,\n            }),\n        ),\n    );\n    return select(\n        {\n            onchange: (e) => {\n                let language = (e.target as HTMLSelectElement).selectedIndex;\n                Config.instance.languageIndex = language;\n            },\n            ...props,\n        },\n        ...languages,\n    );\n};\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { HTMLProps, option, select } from \"chili-controls\";\nimport { Config, Navigation3D } from \"chili-core\";\n\nexport const Navigation3DSelector = (props: HTMLProps<HTMLElement>) => {\n    let nav3DTypes: HTMLOptionElement[] = [];\n    Navigation3D.types.forEach((nav3DType, index) =>\n        nav3DTypes.push(\n            option({\n                selected: index === Config.instance.navigation3DIndex,\n                textContent: nav3DType,\n            }),\n        ),\n    );\n    return select(\n        {\n            onchange: (e) => {\n                let nav3DType = (e.target as HTMLSelectElement).selectedIndex;\n                Config.instance.navigation3DIndex = nav3DType;\n            },\n            ...props,\n        },\n        ...nav3DTypes,\n    );\n};\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { HTMLProps, option, select } from \"chili-controls\";\nimport { Config, I18nKeys, Localize } from \"chili-core\";\n\nexport const ThemeSelector = (props: HTMLProps<HTMLElement>) => {\n    const themes = [\n        { value: \"light\", key: \"common.theme.light\" },\n        { value: \"dark\", key: \"common.theme.dark\" },\n        { value: \"system\", key: \"common.theme.system\" },\n    ];\n\n    let themeOptions: HTMLOptionElement[] = [];\n    themes.forEach((theme) =>\n        themeOptions.push(\n            option({\n                selected: theme.value === Config.instance.themeMode,\n                textContent: new Localize(theme.key as I18nKeys),\n                value: theme.value,\n            }),\n        ),\n    );\n    return select(\n        {\n            onchange: (e) => {\n                let themeMode = (e.target as HTMLSelectElement).value as \"light\" | \"dark\" | \"system\";\n                Config.instance.themeMode = themeMode;\n            },\n            ...props,\n        },\n        ...themeOptions,\n    );\n};\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { a, button, collection, div, img, label, span, svg } from \"chili-controls\";\nimport {\n    Constants,\n    I18n,\n    I18nKeys,\n    IApplication,\n    Localize,\n    ObservableCollection,\n    PubSub,\n    RecentDocumentDTO,\n} from \"chili-core\";\n\nimport style from \"./home.module.css\";\nimport { LanguageSelector } from \"./languageSelector\";\nimport { Navigation3DSelector } from \"./navigation3DSelector\";\nimport { ThemeSelector } from \"./themeSelector\";\n\ninterface ApplicationCommand {\n    display: I18nKeys;\n    icon?: string;\n    onclick: () => void;\n}\n\nconst applicationCommands = new ObservableCollection<ApplicationCommand>(\n    {\n        display: \"command.doc.new\",\n        onclick: () => PubSub.default.pub(\"executeCommand\", \"doc.new\"),\n    },\n    {\n        display: \"command.doc.open\",\n        onclick: () => PubSub.default.pub(\"executeCommand\", \"doc.open\"),\n    },\n);\n\nexport class Home extends HTMLElement {\n    constructor(readonly app: IApplication) {\n        super();\n        this.className = style.root;\n    }\n\n    private hasOpen(documentId: string) {\n        for (const document of this.app.documents) {\n            if (document.id === documentId) return true;\n        }\n        return false;\n    }\n\n    private async getDocuments() {\n        return new ObservableCollection(\n            ...(await this.app.storage.page(Constants.DBName, Constants.RecentTable, 0)),\n        );\n    }\n\n    async render() {\n        const documents = await this.getDocuments();\n        this.append(this.leftSection(), this.rightSection(documents));\n        document.body.appendChild(this);\n    }\n\n    private leftSection() {\n        return div(\n            { className: style.left },\n            div(\n                { className: style.top },\n                this.logoSection(),\n                this.applicationCommands(),\n                this.currentDocument(),\n            ),\n\n            this.settings(),\n            this.links(),\n        );\n    }\n\n    private logoSection() {\n        return div(\n            { className: style.logo },\n            svg({ icon: \"icon-toSolid\" }),\n            span({ textContent: \"Bitcoin 3D\" }),\n            span({ className: style.version, textContent: __APP_VERSION__ }),\n        );\n    }\n\n    private applicationCommands() {\n        return collection({\n            className: style.buttons,\n            sources: applicationCommands,\n            template: (item) =>\n                button({\n                    className: style.button,\n                    textContent: new Localize(item.display),\n                    onclick: item.onclick,\n                }),\n        });\n    }\n\n    private currentDocument() {\n        return this.app.activeView?.document\n            ? button({\n                  className: `${style.button} ${style.back}`,\n                  textContent: new Localize(\"common.back\"),\n                  onclick: () => {\n                      PubSub.default.pub(\"displayHome\", false);\n                  },\n              })\n            : \"\";\n    }\n\n    private settings() {\n        return div(\n            { className: style.settingsPanel },\n            div(\n                { className: style.settingItem },\n                span({\n                    className: style.settingLabel,\n                    textContent: new Localize(\"common.language\"),\n                }),\n                div({ className: style.settingControl }, LanguageSelector({})),\n            ),\n            div(\n                { className: style.settingItem },\n                span({\n                    className: style.settingLabel,\n                    textContent: new Localize(\"common.theme\"),\n                }),\n                div({ className: style.settingControl }, ThemeSelector({})),\n            ),\n            div(\n                { className: style.settingItem },\n                span({\n                    className: style.settingLabel,\n                    textContent: new Localize(\"common.3DNavigation\"),\n                }),\n                div({ className: style.settingControl }, Navigation3DSelector({})),\n            ),\n        );\n    }\n\n    private links() {\n        return div(\n            { className: style.socialPanel },\n            a(\n                {\n                    className: style.socialItem,\n                    href: \"https://github.com/bitcoin-apps-suite/bitcoin-3d\",\n                    target: \"_blank\",\n                    rel: \"noopener noreferrer\",\n                },\n                svg({ icon: \"icon-github\" }),\n                label({ textContent: \"GitHub\" }),\n            ),\n            button(\n                {\n                    className: style.socialItem,\n                    onclick: () => {\n                        PubSub.default.pub(\"executeCommand\", \"wechat.group\");\n                    },\n                },\n                svg({\n                    icon: \"icon-wechatGroup\",\n                }),\n                label({ textContent: new Localize(\"command.wechat.group\") }),\n            ),\n        );\n    }\n\n    private rightSection(documents: ObservableCollection<RecentDocumentDTO>) {\n        return div(\n            { className: style.right },\n            label({ className: style.welcome, textContent: new Localize(\"home.welcome\") }),\n            div({ className: style.recent, textContent: new Localize(\"home.recent\") }),\n            this.documentCollection(documents),\n        );\n    }\n\n    private documentCollection(documents: ObservableCollection<RecentDocumentDTO>) {\n        return collection({\n            className: style.documents,\n            sources: documents,\n            template: (item) => this.recentDocument(item, documents),\n        });\n    }\n\n    private recentDocument(item: RecentDocumentDTO, documents: ObservableCollection<RecentDocumentDTO>) {\n        return div(\n            {\n                className: style.document,\n                onclick: () => this.handleDocumentClick(item),\n            },\n            img({ className: style.img, src: item.image }),\n            this.documentDescription(item),\n            this.deleteIcon(item, documents),\n        );\n    }\n\n    private documentDescription(item: RecentDocumentDTO) {\n        return div(\n            { className: style.description },\n            span({ className: style.title, textContent: item.name }),\n            span({\n                className: style.date,\n                textContent: new Date(item.date).toLocaleDateString(),\n            }),\n        );\n    }\n\n    private deleteIcon(item: RecentDocumentDTO, documents: ObservableCollection<RecentDocumentDTO>) {\n        return svg({\n            className: style.delete,\n            icon: \"icon-times\",\n            onclick: async (e) => {\n                e.stopPropagation();\n                if (window.confirm(I18n.translate(\"prompt.deleteDocument{0}\", item.name))) {\n                    await Promise.all([\n                        this.app.storage.delete(Constants.DBName, Constants.DocumentTable, item.id),\n                        this.app.storage.delete(Constants.DBName, Constants.RecentTable, item.id),\n                    ]);\n                    documents.remove(item);\n                }\n            },\n        });\n    }\n\n    private handleDocumentClick(item: RecentDocumentDTO) {\n        if (this.hasOpen(item.id)) {\n            PubSub.default.pub(\"displayHome\", false);\n        } else {\n            PubSub.default.pub(\n                \"showPermanent\",\n                async () => {\n                    let document = await this.app.openDocument(item.id);\n                    document?.application.activeView?.cameraController.fitContent();\n                },\n                \"toast.excuting{0}\",\n                I18n.translate(\"command.doc.open\"),\n            );\n        }\n    }\n}\n\ncustomElements.define(\"chili-home\", Home);\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { div, span } from \"chili-controls\";\nimport { I18n, I18nKeys } from \"chili-core\";\nimport style from \"./permanent.module.css\";\n\nexport class Permanent {\n    static async show(action: () => Promise<void>, message: I18nKeys, ...args: any[]) {\n        let dialog = document.createElement(\"dialog\");\n        dialog.appendChild(\n            div(\n                { className: style.container },\n                div({\n                    className: style.loading,\n                    style: {\n                        animation: `${style.circle} infinite 0.75s linear`,\n                    },\n                }),\n                span({\n                    className: style.message,\n                    textContent: I18n.translate(message, ...args),\n                }),\n            ),\n        );\n        document.body.appendChild(dialog);\n        dialog.showModal();\n\n        action().finally(() => dialog.remove());\n    }\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport { I18n, I18nKeys } from \"chili-core\";\nimport { label } from \"chili-controls\";\nimport style from \"./toast.module.css\";\n\nexport class Toast {\n    private static _lastToast: [number, HTMLElement] | undefined;\n\n    static readonly info = (message: I18nKeys, ...args: any[]) => {\n        Toast.display(style.info, I18n.translate(message, ...args));\n    };\n\n    static readonly error = (message: string) => {\n        Toast.display(style.error, message);\n    };\n\n    static readonly warn = (message: string) => {\n        Toast.display(style.warning, message);\n    };\n\n    private static display(type: string, message: string) {\n        if (this._lastToast) {\n            clearTimeout(this._lastToast[0]);\n            this._lastToast[1].remove();\n        }\n\n        const toast = label({ className: `${style.toast} ${type}`, textContent: message });\n        document.body.appendChild(toast);\n        this._lastToast = [\n            window.setTimeout(() => {\n                toast.remove();\n                this._lastToast = undefined;\n            }, 2000),\n            toast,\n        ];\n    }\n}\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\n// See LICENSE file in the project root for full license information.\n\nimport {\n    Button,\n    CommandKeys,\n    I18nKeys,\n    IApplication,\n    IWindow,\n    PubSub,\n    RibbonTab,\n    debounce,\n} from \"chili-core\";\nimport { Dialog } from \"./dialog\";\nimport { Editor } from \"./editor\";\nimport { Home } from \"./home\";\nimport { Permanent } from \"./permanent\";\nimport { Toast } from \"./toast\";\ndocument.oncontextmenu = (e) => e.preventDefault();\ndocument.body.addEventListener(\"scroll\", (e) => {\n    document.body.scrollTop = 0;\n});\n\nexport class MainWindow implements IWindow {\n    private _inited: boolean = false;\n    private _home?: Home;\n    private _editor?: Editor;\n\n    constructor(readonly tabs: RibbonTab[]) {\n        // Theme will be set by Config.instance.applyTheme() on initialization\n    }\n\n    init(app: IApplication) {\n        if (this._inited) {\n            throw new Error(\"MainWindow is already inited\");\n        }\n        this._inited = true;\n        this._initHome(app);\n        this._initEditor(app);\n        this._initSubs(app);\n    }\n\n    private _initSubs(app: IApplication) {\n        const displayHome = debounce(this.displayHome, 100);\n        PubSub.default.sub(\"showToast\", Toast.info);\n        PubSub.default.sub(\"displayError\", Toast.error);\n        PubSub.default.sub(\"showDialog\", Dialog.show);\n        PubSub.default.sub(\"showPermanent\", Permanent.show);\n        PubSub.default.sub(\"activeViewChanged\", (view) => displayHome(app, view === undefined));\n        PubSub.default.sub(\"displayHome\", (show) => displayHome(app, show));\n    }\n\n    private readonly displayHome = (app: IApplication, displayHome: boolean) => {\n        if (this._home) {\n            this._home.remove();\n            this._home = undefined;\n        }\n        if (displayHome) {\n            this._initHome(app);\n        }\n    };\n\n    private async _initHome(app: IApplication) {\n        this._home = new Home(app);\n        await this._home.render();\n    }\n\n    private async _initEditor(app: IApplication) {\n        this._editor = new Editor(app, this.tabs);\n    }\n\n    registerHomeCommand(groupName: I18nKeys, command: CommandKeys | Button): void {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    registerRibbonCommand(tabName: I18nKeys, groupName: I18nKeys, command: CommandKeys | Button) {\n        this._editor?.registerRibbonCommand(tabName, groupName, command);\n    }\n\n    setTheme(theme: \"light\" | \"dark\") {\n        document.documentElement.setAttribute(\"theme\", theme);\n    }\n}\n"],"names":["Dialog","title","content","callback","dialog","document","div","style","I18n","button","DialogResult","OKCancel","HTMLElement","span","Localize","icon","text","onClick","svg","control","customElements","TreeItem","node","property","model","setSVGIcon","e","Transaction","label","Binding","parentVisible","TreeGroup","value","nodes","child","items","item","referenceNode","ToolBar","projectView","PubSub","buttons","tip","command","a","expand","tree","first","list","INode","TreeModel","Tree","Map","Set","selected","unselected","x","undefined","event","isLinkList","newParent","target","records","record","ele","parent","pre","group","element","firstChild","result","VisualNode","Error","NodeSelectionHandler","ShapeSelectionHandler","ShapeType","ProjectView","props","view","PropertyBase","objects","ArrayValueConverter","converter","Result","obj","cvalue","String","values","uniqueValues","InputProperty","input","newValue","arrayConverter","commonStyle","des","Object","proto","isPropertyChanged","name","converters","XYZ","XYZConverter","XY","XYConverter","StringConverter","Number","NumberConverter","MatrixProperty","geometries","className","TranslationConverter","ScalingConverter","RotateConverter","MatrixConverter","geometry","y","z","isNaN","matrix","position","rotation","scale","Matrix4","s","translation","Math","CheckProperty","ColorProperty","ColorConverter","color","object","colorStyle","TextureProperty","Expander","display","texture","file","readFileAsync","properties","Property","findPropertyControl","img","PathBinding","UrlStringConverter","MaterialProperty","collection","material","index","id","findMaterial","m","materials","Array","Boolean","ObservableCollection","objs","prop","canShowMaterialProperty","Texture","Logger","PropertyView","controls","FolderNode","Node","GroupNode","entities","parameters","arr","firstElementType","i","count","MaterialDataContent","Observable","editingMaterial","tempMaterial","Material","ActiveStyleConverter","MaterialEditor","dataContent","onclick","isTexture","p","CommandContext","data","Command","groupMap","g","d","visible","type","noType","parseFloat","Combobox","combobox","options","option","select","CancelableCommand","MultistepCommand","newMaterial","RibbonButton","size","commandName","RibbonToggleButton","image","ButtonSize","ToggleConverter","active","isChecked","RibbonStack","RibbonDataContent","app","quickCommands","ribbonTabs","v","QuickButton","ViewActiveConverter","activeStyle","ActivedRibbonTabConverter","tab","DisplayConverter","Ribbon","stack","b","RibbonGroupData","groupName","profile","RibbonTabData","tabName","groups","SnapTypes","ObjectSnapType","SnapConfig","Config","snapType","Statusbar","pan","rotate","Navigation3D","cursors","Cursor","get","Input","handler","error","Tip","msg","newStyle","MessageType","Flyout","level","CameraConverter","Viewport","showViewControls","act","inputBox","ev","container","cameraType","events","listener","LayoutViewport","args","CollectionAction","viewport","Editor","tabs","onMouseMove","sidebarRect","newWidth","window","onMouseUp","controller","document1","context","LanguageSelector","languages","language","Navigation3DSelector","nav3DTypes","nav3DType","ThemeSelector","themeOptions","themes","theme","themeMode","applicationCommands","Home","documentId","Constants","documents","__APP_VERSION__","Date","Promise","Permanent","action","message","Toast","clearTimeout","toast","MainWindow","displayHome","debounce","show"],"mappings":"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"}